<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Filesystems - </title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Filesystems</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="Filesystems" /> <meta property="og:locale" content="en_US" /> <script type="application/ld+json"> {"url":"/General/beginner/filesystems.html","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/nrel.png"}},"headline":"Filesystems","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/blog/" class="nav-list-link">Blog</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/General/general.html" class="nav-list-link">General</a><ul class="nav-list "><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/General/beginner/beginner.html" class="nav-list-link">Beginner</a><ul class="nav-list"><li class="nav-list-item "> <a href="/General/beginner/file-transfers.html" class="nav-list-link">File Transfers</a> </li><li class="nav-list-item active"> <a href="/General/beginner/filesystems.html" class="nav-list-link active">Filesystems</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/General/intermediate/intermediate.html" class="nav-list-link">Intermediate</a><ul class="nav-list"><li class="nav-list-item "> <a href="/General/intermediate/building-packages.html" class="nav-list-link">Building Packages</a> </li></ul></li><li class="nav-list-item "><a href="/python/further-resources.html" class="nav-list-link">Python Additional Resources</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/python/python.html" class="nav-list-link">Python</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/python/dask/dask.html" class="nav-list-link">Dask</a><ul class="nav-list"><li class="nav-list-item "> <a href="/python/dask/dask-mpi.html" class="nav-list-link">Dask-MPI</a> </li></ul></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search " aria-label="Search " autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/General/general.html">General</a></li> <li class="breadcrumb-nav-list-item"><a href="/General/beginner/beginner.html">Beginner</a></li> <li class="breadcrumb-nav-list-item"><span>Filesystems</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="file-systems"> <a href="#file-systems" class="anchor-heading" aria-labelledby="file-systems"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> File systems </h1> <p>Eagle has three primary file systems available for compute nodes. Understanding the usage of these is important for achieving the best performance.</p> <h2 id="nrel-file-systems"> <a href="#nrel-file-systems" class="anchor-heading" aria-labelledby="nrel-file-systems"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NREL file systems </h2> <ul> <li>Home File System <ul> <li>Quota of 50 GB</li> <li>Used to hold scripts, source code, executables</li> </ul> </li> <li>Lustre parallel file system: Accessiblle across all nodes. When using this file system please familiarize yourself with the <a href="#lustre-best-practices">best practices section</a> <ul> <li>/scratch/username</li> <li>/projects</li> <li>/shared-projects</li> <li>/datasets</li> </ul> </li> <li>Node file system: The local drive on each node, these are accessible only on a given node. <ul> <li>/tmp/scratch</li> </ul> </li> </ul> <p>For more information on the file systems available on Eagle please see: <a href="https://www.nrel.gov/hpc/eagle-system-configuration.html">Eagle System Configuration</a></p> <h2 id="lustre-best-practices"> <a href="#lustre-best-practices" class="anchor-heading" aria-labelledby="lustre-best-practices"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lustre best practices </h2> <p>In some cases special care must be taken while using Lustre so as not to affect the performance of the filesystem for yourself and other users. The below Do’s and Don’ts are provided as guidance.</p> <ul> <li><strong>Do</strong> <ul> <li>Use the <code class="language-plaintext highlighter-rouge">lfs find</code> <ul> <li>e.g. <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  lfs find /scratch/username <span class="nt">-type</span> f <span class="nt">-name</span> <span class="s2">"*.py"</span>
</code></pre></div> </div> </li> </ul> </li> <li>Break up directories with many files into more directories if possible</li> <li>Store small files and directories of small files on a single OST.</li> <li>Limit the number of processes accessing a file. It may be better to read in a file once and broadcast necessary information to other processes.</li> <li>Change your stripecount based on the filesize</li> <li>Write many files to the node filesystem <code class="language-plaintext highlighter-rouge">/tmp/scratch/</code> this is not a Lustre filesystem. The files can then be added to a tar archive and transferred to the <code class="language-plaintext highlighter-rouge">/project/project_name</code></li> </ul> </li> <li><strong>Don’t</strong> <ul> <li>Use <code class="language-plaintext highlighter-rouge">ls -l</code></li> <li>Have a file accessed by multiple processes</li> <li>In Python avoid using <code class="language-plaintext highlighter-rouge">os.walk</code> or <code class="language-plaintext highlighter-rouge">os.scandir</code></li> <li>List files instead of using wildcards <ul> <li>e.g. don’t use <code class="language-plaintext highlighter-rouge">cp * dir/</code></li> <li>If you need to tar/rm/cp a large number of files use xargs or similar. <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  lfs find /scratch/username/old_data/ <span class="nt">-t</span> f <span class="nt">-print0</span> | xargs <span class="nt">-0</span> <span class="nb">rm</span>
</code></pre></div> </div> </li> </ul> </li> <li>Have many small files in a single directory</li> <li>Run binary executables from the Lustre filesystem <ul> <li>e.g. don’t keep libraries or programs in /scratch/username <h2 id="useful-lustre-commands"> <a href="#useful-lustre-commands" class="anchor-heading" aria-labelledby="useful-lustre-commands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Useful Lustre commands </h2> </li> </ul> </li> </ul> </li> <li>Check your storage usage: <ul> <li><code class="language-plaintext highlighter-rouge">lfs quota -h -u &lt;username&gt; /scratch</code></li> </ul> </li> <li>See which MDT a directory is located on <ul> <li><code class="language-plaintext highlighter-rouge">lfs getstripe --mdt-index /scratch/&lt;username&gt;</code></li> <li>This will return an index 0-2 indicating the MDT</li> </ul> </li> <li>Create a folder on a specific MDT (admin only) <ul> <li><code class="language-plaintext highlighter-rouge">lfs mkdir –i &lt;mdt_index&gt; /dir_path</code></li> </ul> </li> </ul> <h2 id="striping"> <a href="#striping" class="anchor-heading" aria-labelledby="striping"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Striping </h2> <p>Lustre provides a way to stripe files, this spreads them across multiple OSTs. Striping a large file being accessed by many processes can greatly improve the performace. See <a href="http://wiki.lustre.org/Configuring_Lustre_File_Striping">Lustre file striping</a>for more details.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lfs setstripe &lt;file&gt; -c &lt;count&gt; -s &lt;size&gt;
</code></pre></div></div> <ul> <li>The stripecount determines how many OST the data is spread across</li> <li>The stripe size is how large each of the stripes are in KB, MB, GB</li> </ul> <h2 id="references"> <a href="#references" class="anchor-heading" aria-labelledby="references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> References </h2> <ul> <li><a href="http://doc.lustre.org/lustre_manual.xhtml">Lustre manual</a></li> <li><a href="http://researchcomputing.github.io/meetup_fall_2014/pdfs/fall2014_meetup10_lustre.pdf">CU Boulder - Lustre Do’s and Don’ts</a></li> <li><a href="https://www.nas.nasa.gov/hecc/support/kb/lustre-best-practices_226.html">NASA - Lustre Best Practices</a></li> <li><a href="https://www.nas.nasa.gov/hecc/support/kb/lustre-basics_224.html">NASA - Lustre basics</a></li> <li><a href="https://hpcf.umbc.edu/general-productivity/lustre-best-practices/">UMBC - Lustre Best Practices</a></li> <li><a href="https://www.nics.tennessee.edu/computing-resources/file-systems/io-lustre-tips">NICS - I/O and Lustre Usage</a></li> <li><a href="https://docs.nersc.gov/performance/io/lustre/">NERSC - Lustre</a></li> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
