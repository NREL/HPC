
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tutorial/">
      
      
        <link rel="next" href="../../../Swift/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Building Applications for GPUs - NREL HPC</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-189117140-2"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-189117140-2",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-189117140-2",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#building-and-running-on-kestrels-h100-gpu-nodes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
<!-- Add announcement here, including arbitrary HTML -->
The <a href="https://nrel.github.io/HPC/Documentation/Resource_Management_System/#aus_report-command-line-utility">aus_report</a> CLI utility is now available on Kestrel and Swift for tracking AU usage.
  
          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="NREL HPC" class="md-header__button md-logo" aria-label="NREL HPC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NREL HPC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Building Applications for GPUs
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/NREL/HPC/tree/gh-pages" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    NREL/HPC
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../blog/2020-12-01-numba/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
  
    
  
  Documentation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="NREL HPC" class="md-nav__button md-logo" aria-label="NREL HPC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NREL HPC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NREL/HPC/tree/gh-pages" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    NREL/HPC
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2020-12-01-numba/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Speeding up Python Code with Numba
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2021-05-06-tf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Faster Machine Learning with Custom Built TensorFlow on Eagle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2021-06-18-srun/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using srun to Launch Applications Under Slurm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2022-02-02-Changes_to_Slurm_srun_for_interactive_jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changes to Slurm "srun" for Interactive Jobs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2022-10-04-python2to3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Legacy Python 2 Code on Eagle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2022-03-05-local-io-performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local I/O Performance on Eagle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2022-12-19-windows_ssh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workaround for Windows SSH "Corrupted MAC on input" Error
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2023-01-10-using_specific_module_versions_on_hpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Specific Module Versions on the HPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/2023-11-28_module_updates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Module Updates on Kestrel for November 2023
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Help and Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Resource_Management_System/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Allocation Management System
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Allocation Management System
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Systems
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Kestrel
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5_2" id="__nav_3_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_5_2">
            <span class="md-nav__icon md-icon"></span>
            Kestrel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Running/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Running on Kestrel
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5_2_2" id="__nav_3_5_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            Running on Kestrel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Running/kestrel_job_priorities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Job Priorities on Kestrel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Running/example_sbatch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example Sbatch Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Running/performancerecs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Recommendations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Filesystems/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Filesystems
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5_2_3" id="__nav_3_5_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_5_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_2_3">
            <span class="md-nav__icon md-icon"></span>
            Filesystems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Filesystems/lustre/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lustre Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kestrel_release_notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kestrel Release Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_2_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Environments
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5_2_5" id="__nav_3_5_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_5_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_5_2_5">
            <span class="md-nav__icon md-icon"></span>
            Environments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_2_5_2" >
        
          
          <label class="md-nav__link" for="__nav_3_5_2_5_2" id="__nav_3_5_2_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Toolchains
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_5_2_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_2_5_2">
            <span class="md-nav__icon md-icon"></span>
            Toolchains
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Toolchains/intel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Toolchains/others/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MPI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environments Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Building Applications for GPUs
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Building Applications for GPUs
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#note-about-gccgfortran" class="md-nav__link">
    <span class="md-ellipsis">
      Note about gcc/gfortran
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Note about gcc/gfortran">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#module-load-gcc-native121" class="md-nav__link">
    <span class="md-ellipsis">
      module load gcc-native/12.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-load-gcc1220" class="md-nav__link">
    <span class="md-ellipsis">
      module load gcc/12.2.0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-load-gcc-standalone1310" class="md-nav__link">
    <span class="md-ellipsis">
      module load gcc-standalone/13.1.0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-load-gcc-standalone1230" class="md-nav__link">
    <span class="md-ellipsis">
      module load gcc-standalone/12.3.0
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helper-files" class="md-nav__link">
    <span class="md-ellipsis">
      Helper files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Helper files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#just-mpi" class="md-nav__link">
    <span class="md-ellipsis">
      Just MPI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programming-paradigms-discussed" class="md-nav__link">
    <span class="md-ellipsis">
      Programming paradigms Discussed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-issues-addressed-with-these-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Common issues addressed with these examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-examples" class="md-nav__link">
    <span class="md-ellipsis">
      The examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-notes-for-all-examples" class="md-nav__link">
    <span class="md-ellipsis">
      General notes for all examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-script" class="md-nav__link">
    <span class="md-ellipsis">
      The script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudagccalso" class="md-nav__link">
    <span class="md-ellipsis">
      cuda/gccalso
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudanvidia" class="md-nav__link">
    <span class="md-ellipsis">
      cuda/nvidia
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpinormalcray" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/normal/cray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpinormalintelabi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/normal/intel+abi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpinormalnvidianrelopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/normal/nvidia/nrelopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpinormalnvidianvidiaopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/normal/nvidia/nvidiaopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiwithcudacray" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/withcuda/cray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiwithcudanvidianrelopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/withcuda/nvidia/nrelopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiwithcudanvidianvidiaopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/withcuda/nvidia/nvidiaopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpicudaaware" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/cudaaware
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openacccray" class="md-nav__link">
    <span class="md-ellipsis">
      openacc/cray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openaccnvidia" class="md-nav__link">
    <span class="md-ellipsis">
      openacc/nvidia
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiopenacccray" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/openacc/cray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiopenaccnvidianrelopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/openacc/nvidia/nrelopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiopenaccnvidianvidiaopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/openacc/nvidia/nvidiaopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudalibfactor" class="md-nav__link">
    <span class="md-ellipsis">
      cudalib/factor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudalibfft" class="md-nav__link">
    <span class="md-ellipsis">
      cudalib/fft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-credits" class="md-nav__link">
    <span class="md-ellipsis">
      Source credits
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Swift/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Swift
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5_3" id="__nav_3_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_3">
            <span class="md-nav__icon md-icon"></span>
            Swift
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Swift/running/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running on Swift
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Swift/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Swift/filesystems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Filesystems
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Vermilion/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Vermilion
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5_4" id="__nav_3_5_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_4">
            <span class="md-nav__icon md-icon"></span>
            Vermilion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Vermilion/running/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running on Vermilion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Slurm/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Slurm Job Scheduling
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Slurm Job Scheduling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Slurm/monitor_and_control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitor and Control Commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Slurm/batch_jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Submitting Batch Jobs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Slurm/interactive_jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Interactive Jobs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Slurm/multiple_sub_jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiple Sub-Jobs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Slurm/job_arrays/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Job Arrays
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Managing your Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Managing your Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Managing_Data/file_permissions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unix File Permissions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Managing_Data/mss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mass Storage System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Managing_Data/localstorage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Node Local Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Managing_Data/Transferring_Files/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Transferring Files
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_4" id="__nav_3_7_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_4">
            <span class="md-nav__icon md-icon"></span>
            Transferring Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Managing_Data/Transferring_Files/FileZilla/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FileZilla
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Managing_Data/Transferring_Files/globus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transferring Files with Globus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Managing_Data/Transferring_Files/winscp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WinSCP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Environment
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Environment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Environment/shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shell Startup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Environment/lmod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lmod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Environment/Customization/conda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conda
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Environment/Building_Packages/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Building an Application
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_8_4" id="__nav_3_8_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8_4">
            <span class="md-nav__icon md-icon"></span>
            Building an Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Environment/Building_Packages/acquire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting the package
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Environment/Building_Packages/config_make_install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config, Make, Install
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Environment/Building_Packages/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create a Modulefile
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Applications/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Applications
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/alphafold/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AlphaFold
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/ansys/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ANSYS CFD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/exawind/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ExaWind
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/chemicalKinetics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chemical Kinetics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/comsol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    COMSOL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/fenics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FEniCS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/gams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GAMS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/gaussian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/gurobi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gurobi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/idaes_solvers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IDAES Solvers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/ipopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IPOPT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/lammps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LAMMPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/mace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MACE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9_15" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Applications/Matlab/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    MATLAB
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_9_15" id="__nav_3_9_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_9_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9_15">
            <span class="md-nav__icon md-icon"></span>
            MATLAB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/Matlab/batch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Batch Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/Matlab/interactive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interactive Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/Matlab/parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parallel Computing Toolbox
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/Matlab/versions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Versions and Licenses
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/openfast/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenFAST/FAST.Farm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/openfoam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenFOAM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9_18" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Applications/Plexos/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    PLEXOS
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_9_18" id="__nav_3_9_18_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_9_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9_18">
            <span class="md-nav__icon md-icon"></span>
            PLEXOS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/Plexos/setup_plexos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setting Up
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/Plexos/run_plexos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/qchem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Q-Chem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/starccm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    STAR-CCM+
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/vasp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VASP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/wrf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WRF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Applications/xpressmp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Xpress
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
        
          
          <label class="md-nav__link" for="__nav_3_10" id="__nav_3_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_1" >
        
          
          <label class="md-nav__link" for="__nav_3_10_1" id="__nav_3_10_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Languages
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_1">
            <span class="md-nav__icon md-icon"></span>
            Languages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/Languages/Julia/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Julia
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_10_1_1" id="__nav_3_10_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_10_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_1_1">
            <span class="md-nav__icon md-icon"></span>
            Julia
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/Julia/julia_install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing Julia
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/Julia/julia_tour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tour of Julia
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/Julia/julia_parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Julia Parallel Computing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/Julia/julia_ccall_pycall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PyCall and CCall
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/c%2B%2B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/r/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    R
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/bash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bash
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/Languages/Fortran/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Fortran
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_10_1_5" id="__nav_3_10_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_10_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_1_5">
            <span class="md-nav__icon md-icon"></span>
            Fortran
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/Fortran/f90_advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_1_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/Languages/Python/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_10_1_6" id="__nav_3_10_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_10_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_1_6">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/Python/KestrelParallelPythonJupyter/pyEnvsAndLaunchingJobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parallel Python with Jupyter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Languages/Python/dask/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dask
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/Jupyter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Jupyter
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_2">
            <span class="md-nav__icon md-icon"></span>
            Jupyter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_3" >
        
          
          <label class="md-nav__link" for="__nav_3_10_3" id="__nav_3_10_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Programming Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_3">
            <span class="md-nav__icon md-icon"></span>
            Programming Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Programming_Models/mpi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MPI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Programming_Models/gpu_hpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using GPUs for HPC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Compilers/rosetta_stone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compilers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_5" >
        
          
          <label class="md-nav__link" for="__nav_3_10_5" id="__nav_3_10_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Build Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_5">
            <span class="md-nav__icon md-icon"></span>
            Build Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Build_Tools/cmake/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CMake
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Build_Tools/spack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Build_Tools/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/Libraries/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Libraries
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_10_6" id="__nav_3_10_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_6">
            <span class="md-nav__icon md-icon"></span>
            Libraries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Libraries/howto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Libraries How-to
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Libraries/fftw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FFTW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Libraries/hdf5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HDF5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Libraries/hsl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Libraries/lapack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LAPACK and ScaLAPACK
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Libraries/libsci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LibSci
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Libraries/mkl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MKL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Libraries/petsc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PETSc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_7" >
        
          
          <label class="md-nav__link" for="__nav_3_10_7" id="__nav_3_10_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Performance Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_7">
            <span class="md-nav__icon md-icon"></span>
            Performance Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_7_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/Performance_Tools/Linaro-Forge/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Linaro-Forge
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_10_7_1" id="__nav_3_10_7_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_10_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_7_1">
            <span class="md-nav__icon md-icon"></span>
            Linaro-Forge
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Performance_Tools/Linaro-Forge/map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MAP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Performance_Tools/Linaro-Forge/performance_rep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Reports
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_7_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/Performance_Tools/Intel/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    oneAPI Tools
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_10_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_7_2">
            <span class="md-nav__icon md-icon"></span>
            oneAPI Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_8" >
        
          
          <label class="md-nav__link" for="__nav_3_10_8" id="__nav_3_10_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Debug Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_8">
            <span class="md-nav__icon md-icon"></span>
            Debug Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Debug_Tools/ddt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DDT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Debug_Tools/gdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GDB
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/VSCode/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Visual Studio Code
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_9">
            <span class="md-nav__icon md-icon"></span>
            Visual Studio Code
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Development/Containers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Containers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_10_10" id="__nav_3_10_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10_10">
            <span class="md-nav__icon md-icon"></span>
            Containers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Containers/registries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Container registries at NREL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Containers/singularity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Singularity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Development/Containers/apptainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Apptainer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Viz_Analytics/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Visualization and Analytics
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_11" id="__nav_3_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_11">
            <span class="md-nav__icon md-icon"></span>
            Visualization and Analytics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Viz_Analytics/virtualgl_fastx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VirtualGL and FastX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Viz_Analytics/paraview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Paraview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Viz_Analytics/visit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VisIT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_12" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Machine_Learning/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Machine Learning
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_12" id="__nav_3_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12">
            <span class="md-nav__icon md-icon"></span>
            Machine Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Machine_Learning/Reinforcement_Learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reinforcement Learning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Machine_Learning/TensorBoard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TensorBoard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Machine_Learning/Containerized_TensorFlow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Containerized TensorFlow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#note-about-gccgfortran" class="md-nav__link">
    <span class="md-ellipsis">
      Note about gcc/gfortran
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Note about gcc/gfortran">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#module-load-gcc-native121" class="md-nav__link">
    <span class="md-ellipsis">
      module load gcc-native/12.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-load-gcc1220" class="md-nav__link">
    <span class="md-ellipsis">
      module load gcc/12.2.0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-load-gcc-standalone1310" class="md-nav__link">
    <span class="md-ellipsis">
      module load gcc-standalone/13.1.0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-load-gcc-standalone1230" class="md-nav__link">
    <span class="md-ellipsis">
      module load gcc-standalone/12.3.0
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helper-files" class="md-nav__link">
    <span class="md-ellipsis">
      Helper files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Helper files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#just-mpi" class="md-nav__link">
    <span class="md-ellipsis">
      Just MPI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programming-paradigms-discussed" class="md-nav__link">
    <span class="md-ellipsis">
      Programming paradigms Discussed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-issues-addressed-with-these-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Common issues addressed with these examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-examples" class="md-nav__link">
    <span class="md-ellipsis">
      The examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-notes-for-all-examples" class="md-nav__link">
    <span class="md-ellipsis">
      General notes for all examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-script" class="md-nav__link">
    <span class="md-ellipsis">
      The script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudagccalso" class="md-nav__link">
    <span class="md-ellipsis">
      cuda/gccalso
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudanvidia" class="md-nav__link">
    <span class="md-ellipsis">
      cuda/nvidia
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpinormalcray" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/normal/cray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpinormalintelabi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/normal/intel+abi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpinormalnvidianrelopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/normal/nvidia/nrelopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpinormalnvidianvidiaopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/normal/nvidia/nvidiaopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiwithcudacray" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/withcuda/cray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiwithcudanvidianrelopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/withcuda/nvidia/nrelopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiwithcudanvidianvidiaopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/withcuda/nvidia/nvidiaopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpicudaaware" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/cudaaware
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openacccray" class="md-nav__link">
    <span class="md-ellipsis">
      openacc/cray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openaccnvidia" class="md-nav__link">
    <span class="md-ellipsis">
      openacc/nvidia
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiopenacccray" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/openacc/cray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiopenaccnvidianrelopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/openacc/nvidia/nrelopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpiopenaccnvidianvidiaopenmpi" class="md-nav__link">
    <span class="md-ellipsis">
      mpi/openacc/nvidia/nvidiaopenmpi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudalibfactor" class="md-nav__link">
    <span class="md-ellipsis">
      cudalib/factor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cudalibfft" class="md-nav__link">
    <span class="md-ellipsis">
      cudalib/fft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-credits" class="md-nav__link">
    <span class="md-ellipsis">
      Source credits
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="building-and-running-on-kestrels-h100-gpu-nodes">Building and Running on Kestrel's H100 GPU nodes.<a class="headerlink" href="#building-and-running-on-kestrels-h100-gpu-nodes" title="Permanent link">#</a></h1>
<p>This page describes how to build and run on Kestrel's GPU nodes using several programming paradigms.  There are pure Cuda programs, Cuda aware MPI programs, MPI programs without Cuda, MPI programs with Cuda, MPI programs with Openacc, and pure Openacc programs. </p>
<p>The examples are contained in a tarball available on Kestrel via the command:</p>
<div class="highlight"><pre><span></span><code>tar<span class="w"> </span>-xzf<span class="w"> </span>/nopt/nrel/apps/examples/gpu/h100.tgz
</code></pre></div>
<p>Or you can use git to do a download:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span><span class="nv">$USER</span>@kestrel.hpc.nrel.gov:/nopt/nrel/apps/examples/gpu/0824<span class="w"> </span>h100
</code></pre></div>
<p>After getting the source you can run all of the examples:</p>
<p><div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>h100
sbatch<span class="w"> </span>--account<span class="o">=</span>MYACCOUNT<span class="w"> </span>script
</code></pre></div>
where you need to provide your account name.  This will run in about 22 minutes using 2 GPU nodes.  Some of the examples require 2 nodes but most will run on a single node.</p>
<h2 id="note-about-gccgfortran">Note about gcc/gfortran<a class="headerlink" href="#note-about-gccgfortran" title="Permanent link">#</a></h2>
<p>Almost all compiling/running on a linux system will at some point reference or in some way use some portion of the GNU (gcc/gfortran/linker) system.  Kestrel has many versions of gcc.  These fall into three categories:</p>
<ul>
<li>Native to the Operating system</li>
<li>Built by Cray</li>
<li>Built by NREL</li>
</ul>
<p>You will also see modules for "mixed" versions.  These are just duplicates of others and should not be loaded.</p>
<p>Here are some of the options:  </p>
<h4 id="module-load-gcc-native121">module load  gcc-native/12.1<a class="headerlink" href="#module-load-gcc-native121" title="Permanent link">#</a></h4>
<ul>
<li>which gcc<ul>
<li>/opt/rh/gcc-toolset-12/root/usr/bin/gcc</li>
</ul>
</li>
<li>Native to the operating system</li>
</ul>
<h4 id="module-load-gcc1220">module load gcc/12.2.0<a class="headerlink" href="#module-load-gcc1220" title="Permanent link">#</a></h4>
<ul>
<li>which gcc<ul>
<li>/opt/cray/pe/gcc/12.2.0/bin/gcc</li>
</ul>
</li>
<li>Built by the vendor</li>
</ul>
<h4 id="module-load-gcc-standalone1310">module load gcc-standalone/13.1.0<a class="headerlink" href="#module-load-gcc-standalone1310" title="Permanent link">#</a></h4>
<ul>
<li>which gcc<ul>
<li>/nopt/nrel/apps/gpu_stack/compilers/03-24/.../gcc-13.1.0.../bin/gcc</li>
</ul>
</li>
<li>Built by NREL</li>
</ul>
<h4 id="module-load-gcc-standalone1230">module load gcc-standalone/12.3.0<a class="headerlink" href="#module-load-gcc-standalone1230" title="Permanent link">#</a></h4>
<ul>
<li>which gcc<ul>
<li>/nopt/nrel/apps/cpu_stack/compilers/06-24/.../gcc-12.3.0.../bin/gcc</li>
</ul>
</li>
<li>Built by NREL</li>
</ul>
<h2 id="helper-files">Helper files<a class="headerlink" href="#helper-files" title="Permanent link">#</a></h2>
<p>There are a number of "helper" files  shipped with the examples.  The script <em>onnodes</em> is run while you have a job running.  You specify the jobid and it will report what is running on each node owned by the job.  This will include the core on which each task/thread is running.  On GPU nodes it will also report what you have running on each GPU.</p>
<details class="example">
<summary>onnodes script</summary>
<div class="highlight"><pre><span></span><code><span class="o">[</span>tkaiser2@kl6<span class="w"> </span>h100<span class="o">]</span>$<span class="w"> </span>./onnodes
x3102c0s41b0n0
PID<span class="w">    </span>LWP<span class="w"> </span>PSR<span class="w"> </span>COMMAND<span class="w">         </span>%CPU
<span class="m">3658483</span><span class="w"> </span><span class="m">3659124</span><span class="w">   </span><span class="m">4</span><span class="w"> </span>jacobi<span class="w">           </span><span class="m">0</span>.0
<span class="m">3653038</span><span class="w"> </span><span class="m">3653038</span><span class="w">  </span><span class="m">14</span><span class="w"> </span><span class="o">(</span>sd-pam<span class="o">)</span><span class="w">         </span><span class="m">0</span>.0
<span class="m">3653037</span><span class="w"> </span><span class="m">3653037</span><span class="w">  </span><span class="m">16</span><span class="w"> </span>systemd<span class="w">          </span><span class="m">0</span>.0
<span class="m">3659075</span><span class="w"> </span><span class="m">3659075</span><span class="w">  </span><span class="m">27</span><span class="w"> </span>sshd<span class="w">             </span><span class="m">0</span>.0
<span class="m">3658483</span><span class="w"> </span><span class="m">3658499</span><span class="w">  </span><span class="m">52</span><span class="w"> </span>cuda00001800007<span class="w">  </span><span class="m">0</span>.0
<span class="m">3658480</span><span class="w"> </span><span class="m">3658497</span><span class="w">  </span><span class="m">64</span><span class="w"> </span>cuda00001800007<span class="w">  </span><span class="m">0</span>.0
<span class="m">3658481</span><span class="w"> </span><span class="m">3658481</span><span class="w">  </span><span class="m">65</span><span class="w"> </span>jacobi<span class="w">          </span><span class="m">23</span>.6
<span class="m">3658481</span><span class="w"> </span><span class="m">3659129</span><span class="w">  </span><span class="m">66</span><span class="w"> </span>jacobi<span class="w">           </span><span class="m">0</span>.0
<span class="m">3658482</span><span class="w"> </span><span class="m">3658482</span><span class="w">  </span><span class="m">72</span><span class="w"> </span>jacobi<span class="w">          </span><span class="m">20</span>.8
<span class="m">3658482</span><span class="w"> </span><span class="m">3658498</span><span class="w">  </span><span class="m">79</span><span class="w"> </span>cuda00001800007<span class="w">  </span><span class="m">0</span>.0
<span class="m">3658480</span><span class="w"> </span><span class="m">3658480</span><span class="w">  </span><span class="m">84</span><span class="w"> </span>jacobi<span class="w">          </span><span class="m">64</span>.6
<span class="m">3658483</span><span class="w"> </span><span class="m">3658483</span><span class="w">  </span><span class="m">88</span><span class="w"> </span>jacobi<span class="w">          </span><span class="m">20</span>.2
<span class="m">3658480</span><span class="w"> </span><span class="m">3659127</span><span class="w">  </span><span class="m">89</span><span class="w"> </span>jacobi<span class="w">           </span><span class="m">0</span>.0
<span class="m">3658481</span><span class="w"> </span><span class="m">3658496</span><span class="w">  </span><span class="m">92</span><span class="w"> </span>cuda00001800007<span class="w">  </span><span class="m">0</span>.0
<span class="m">3659076</span><span class="w"> </span><span class="m">3659076</span><span class="w">  </span><span class="m">95</span><span class="w"> </span>ps<span class="w">               </span><span class="m">0</span>.0
<span class="m">3658482</span><span class="w"> </span><span class="m">3659125</span><span class="w"> </span><span class="m">101</span><span class="w"> </span>jacobi<span class="w">           </span><span class="m">0</span>.0
/usr/bin/nvidia-smi
Wed<span class="w"> </span>Aug<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">11</span>:55:50<span class="w"> </span><span class="m">2024</span><span class="w">       </span>
+-----------------------------------------------------------------------------------------+
<span class="p">|</span><span class="w"> </span>NVIDIA-SMI<span class="w"> </span><span class="m">550</span>.54.15<span class="w">              </span>Driver<span class="w"> </span>Version:<span class="w"> </span><span class="m">550</span>.54.15<span class="w">      </span>CUDA<span class="w"> </span>Version:<span class="w"> </span><span class="m">12</span>.4<span class="w">     </span><span class="p">|</span>
<span class="p">|</span>-----------------------------------------+------------------------+----------------------+
<span class="p">|</span><span class="w"> </span>GPU<span class="w">  </span>Name<span class="w">                 </span>Persistence-M<span class="w"> </span><span class="p">|</span><span class="w"> </span>Bus-Id<span class="w">          </span>Disp.A<span class="w"> </span><span class="p">|</span><span class="w"> </span>Volatile<span class="w"> </span>Uncorr.<span class="w"> </span>ECC<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Fan<span class="w">  </span>Temp<span class="w">   </span>Perf<span class="w">          </span>Pwr:Usage/Cap<span class="w"> </span><span class="p">|</span><span class="w">           </span>Memory-Usage<span class="w"> </span><span class="p">|</span><span class="w"> </span>GPU-Util<span class="w">  </span>Compute<span class="w"> </span>M.<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                        </span><span class="p">|</span><span class="w">               </span>MIG<span class="w"> </span>M.<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="o">=========================================</span>+<span class="o">========================</span>+<span class="o">======================</span><span class="p">|</span>
<span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span>NVIDIA<span class="w"> </span>H100<span class="w"> </span>80GB<span class="w"> </span>HBM3<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">00000000</span>:04:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                    </span><span class="m">0</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>42C<span class="w">    </span>P0<span class="w">            </span>126W<span class="w"> </span>/<span class="w">  </span>699W<span class="w"> </span><span class="p">|</span><span class="w">     </span>532MiB<span class="w"> </span>/<span class="w">  </span>81559MiB<span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="m">0</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                        </span><span class="p">|</span><span class="w">             </span>Disabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+------------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">  </span>NVIDIA<span class="w"> </span>H100<span class="w"> </span>80GB<span class="w"> </span>HBM3<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">00000000</span>:64:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                    </span><span class="m">0</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>42C<span class="w">    </span>P0<span class="w">            </span>123W<span class="w"> </span>/<span class="w">  </span>699W<span class="w"> </span><span class="p">|</span><span class="w">     </span>532MiB<span class="w"> </span>/<span class="w">  </span>81559MiB<span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="m">0</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                        </span><span class="p">|</span><span class="w">             </span>Disabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+------------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">2</span><span class="w">  </span>NVIDIA<span class="w"> </span>H100<span class="w"> </span>80GB<span class="w"> </span>HBM3<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">00000000</span>:84:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                    </span><span class="m">0</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>42C<span class="w">    </span>P0<span class="w">            </span>123W<span class="w"> </span>/<span class="w">  </span>699W<span class="w"> </span><span class="p">|</span><span class="w">     </span>532MiB<span class="w"> </span>/<span class="w">  </span>81559MiB<span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="m">0</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                        </span><span class="p">|</span><span class="w">             </span>Disabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+------------------------+----------------------+
<span class="p">|</span><span class="w">   </span><span class="m">3</span><span class="w">  </span>NVIDIA<span class="w"> </span>H100<span class="w"> </span>80GB<span class="w"> </span>HBM3<span class="w">          </span>On<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">00000000</span>:E4:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                    </span><span class="m">0</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>43C<span class="w">    </span>P0<span class="w">            </span>119W<span class="w"> </span>/<span class="w">  </span>699W<span class="w"> </span><span class="p">|</span><span class="w">     </span>532MiB<span class="w"> </span>/<span class="w">  </span>81559MiB<span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="m">0</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                        </span><span class="p">|</span><span class="w">             </span>Disabled<span class="w"> </span><span class="p">|</span>
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
<span class="p">|</span><span class="w"> </span>Processes:<span class="w">                                                                              </span><span class="p">|</span>
<span class="p">|</span><span class="w">  </span>GPU<span class="w">   </span>GI<span class="w">   </span>CI<span class="w">        </span>PID<span class="w">   </span>Type<span class="w">   </span>Process<span class="w"> </span>name<span class="w">                              </span>GPU<span class="w"> </span>Memory<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span>ID<span class="w">   </span>ID<span class="w">                                                               </span>Usage<span class="w">      </span><span class="p">|</span>
<span class="p">|</span><span class="o">=========================================================================================</span><span class="p">|</span>
<span class="p">|</span><span class="w">    </span><span class="m">0</span><span class="w">   </span>N/A<span class="w">  </span>N/A<span class="w">   </span><span class="m">3658480</span><span class="w">      </span>C<span class="w">   </span>...try2/h100/mpi/openacc/cray/./jacobi<span class="w">        </span>522MiB<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">   </span>N/A<span class="w">  </span>N/A<span class="w">   </span><span class="m">3658481</span><span class="w">      </span>C<span class="w">   </span>...try2/h100/mpi/openacc/cray/./jacobi<span class="w">        </span>522MiB<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">    </span><span class="m">2</span><span class="w">   </span>N/A<span class="w">  </span>N/A<span class="w">   </span><span class="m">3658482</span><span class="w">      </span>C<span class="w">   </span>...try2/h100/mpi/openacc/cray/./jacobi<span class="w">        </span>522MiB<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">    </span><span class="m">3</span><span class="w">   </span>N/A<span class="w">  </span>N/A<span class="w">   </span><span class="m">3658483</span><span class="w">      </span>C<span class="w">   </span>...try2/h100/mpi/openacc/cray/./jacobi<span class="w">        </span>522MiB<span class="w"> </span><span class="p">|</span>
+-----------------------------------------------------------------------------------------+
<span class="o">[</span>tkaiser2@kl6<span class="w"> </span>h100<span class="o">]</span>$
</code></pre></div>
</details>
<p>There is a function <em>module_restore</em> defined in /nopt/nrel/apps/env.sh.
Sourcing /nopt/nrel/apps/env.sh sets modules back to the original state.
module_restore also modifies $PATH and $LD_LIBRARY_PATH putting paths with your 
home directory at the beginning.</p>
<div class="highlight"><pre><span></span><code>. /nopt/nrel/apps/env.sh
module_restore
</code></pre></div>
<p>As of October 2024, /nopt/nrel/apps/env.sh is sourced automatically when you login so the
function module_restore should be in you path.</p>
<h3 id="just-mpi">Just MPI<a class="headerlink" href="#just-mpi" title="Permanent link">#</a></h3>
<p>There is an extra slurm script <em>quick</em> which does a build of C and Fortran MPI hello world.  The script shows that to get a MPI program to build with the standard Programing environments PrgEnv-{cray,intel,gnu} you must module unload nvhpc and module load cuda.  These environments build using Cray's MPI and the various back end compilers.  There is a conflict between the default version of nvhpc and these environments.  Also, Cray MPI wants cuda even if the program being built does not require it.</p>
<h2 id="programming-paradigms-discussed">Programming paradigms Discussed<a class="headerlink" href="#programming-paradigms-discussed" title="Permanent link">#</a></h2>
<ul>
<li>Multiple GPUs &amp; multiple nodes <ul>
<li>Pure Cuda programs</li>
<li>Cuda aware MPI programs</li>
<li>MPI programs without Cuda,</li>
<li>MPI programs with Cuda</li>
<li>MPI programs with Openacc</li>
<li>Pure Openacc programs.   </li>
<li>Library routines</li>
</ul>
</li>
<li>We’ll build with: <ul>
<li>Cray’s standard programming environment </li>
<li>NVIDIA’s environment</li>
<li>Gcc</li>
<li>A few examples with Intel MPI</li>
</ul>
</li>
</ul>
<h2 id="common-issues-addressed-with-these-examples">Common issues addressed with these examples<a class="headerlink" href="#common-issues-addressed-with-these-examples" title="Permanent link">#</a></h2>
<ul>
<li>Can’t find library at run time<ul>
<li>Need to set LD_LIBRARY_PATH to point to directory containing the library. Try to load modules at run time.</li>
</ul>
</li>
<li>Module xxx is not compatible with your cray-libsci.<ul>
<li>Load an different version:  cray-libsci/22.10.1.2 or cray-libsci/22.12.1.1  or   cray-libsci/23.05.1.4</li>
</ul>
</li>
<li>Can’t find some function in the c++ library.<ul>
<li>Load a newer version of gcc</li>
</ul>
</li>
<li>At link time libgcc_s.so.1: file not recognized: File format not recognized.<ul>
<li>Linker is missing after some combinations of loads.</li>
<li>module load binutils</li>
</ul>
</li>
<li>Examples shown here don’t work.<ul>
<li>Make sure you are running and or launching from a GPU node</li>
</ul>
</li>
<li>cc1: error: bad value ‘znver4’ for ‘-march=’ switch.<ul>
<li>-march=skylake</li>
</ul>
</li>
<li>Package 'nccl', required by 'virtual:world', not found…<ul>
<li>module unload nvhpc</li>
</ul>
</li>
<li>lib/libmpi_gtl_cuda.so: undefined reference to…<ul>
<li>module load cuda</li>
</ul>
</li>
</ul>
<h2 id="the-examples">The examples<a class="headerlink" href="#the-examples" title="Permanent link">#</a></h2>
<p>The examples are spread across a number of directories.  All examples can be run with a single sbatch command.</p>
<ul>
<li>Our driver script is just "script".</li>
<li>Each example directory contains a file "doit".</li>
<li>Our driver looks for each directory with an example; Goes there and sources doit.</li>
<li>
<p>We can select the default gcc compiler to use by setting the environmental variable MYGCC; This can be done outside of the script before sbatch. The possible versions of gcc are set as shown below:</p>
<ul>
<li>export MYGCC=gcc-native/12.1</li>
<li>export MYGCC=gcc-stdalone/10.1.0</li>
<li>export MYGCC=gcc-stdalone/12.3.0 </li>
<li>export MYGCC=gcc-stdalone/13.1.0</li>
</ul>
</li>
<li>
<p>If we know that an example will not run with the chosen version of gcc "doit" will substitute on the fly</p>
</li>
<li>You can run a subset of the tests by setting the variable doits.  For example:</li>
</ul>
<div class="highlight"><pre><span></span><code>export doits=&quot;./cudalib/factor/doit ./cudalib/fft/doit ./mpi/cudaaware/doit&quot;
</code></pre></div>
<h2 id="general-notes-for-all-examples">General notes for all examples<a class="headerlink" href="#general-notes-for-all-examples" title="Permanent link">#</a></h2>
<ul>
<li>All examples run module_restore to set the environment to a know state.  See above.</li>
<li>Many of the examples unload  PrgEnv-cray/8.5.0 and nvhpc/24.1 to prevent conflicts with other modules.</li>
<li>There is a compile and run of one or more programs.  </li>
<li>MPI programs are run with srun or mpirun on one or two nodes.  Mpirun is used with some versions of NVIDIA's environment because srun is not supported.</li>
<li>GPU programs that use a single GPU are run on each GPU in turn.</li>
</ul>
<h2 id="the-script">The script<a class="headerlink" href="#the-script" title="Permanent link">#</a></h2>
<p>Our script, shown below does the following:</p>
<ol>
<li>Test to make sure we are starting from a GPU node.</li>
<li>Define a simple timer.</li>
<li>Save our environment and a copy of the script.</li>
<li>Bring the function module_restore into our environment (see above).</li>
<li>Set our default version of gcc.</li>
<li>Find our examples if the user has not set a list beforehand and echo our list.</li>
<li>Go into each directory and run the test.</li>
</ol>
<details class="example">
<summary>script</summary>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --time=0:30:00</span>
<span class="c1">#SBATCH --partition=gpu-h100</span>
<span class="c1">#SBATCH --nodes=2</span>
<span class="c1">#SBATCH --gres=gpu:h100:4</span>
<span class="c1">#SBATCH --exclusive</span>
<span class="c1">#SBATCH --output=output-%j.out</span>
<span class="c1">#SBATCH --error=infor-%j.out</span>

func<span class="w"> </span><span class="o">()</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">typeset</span><span class="w"> </span>-f<span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">alias</span><span class="w"> </span><span class="nv">$1</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
func<span class="w"> </span>module<span class="w"> </span>&gt;<span class="w"> </span>module.<span class="nv">$SLURM_JOB_ID</span>

<span class="c1"># we &quot;overload&quot; srun here to not allow any one subjob has </span>
<span class="c1"># a problem and to runs too long.  this should not happen.</span>
<span class="nb">alias</span><span class="w"> </span><span class="nv">srun</span><span class="o">=</span><span class="s2">&quot;/nopt/slurm/current/bin/srun --time=00:05:00 </span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="k">if</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$SLURM_SUBMIT_HOST</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span><span class="s2">&quot;kl5|kl6&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/dev/null<span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>:<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>Run<span class="w"> </span>script<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>GPU<span class="w"> </span>node<span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<span class="c1"># a simple timer</span>
dt<span class="w"> </span><span class="o">()</span>
<span class="o">{</span>
<span class="w">    </span><span class="nv">now</span><span class="o">=</span><span class="sb">`</span>date<span class="w"> </span>+<span class="s2">&quot;%s.%N&quot;</span><span class="sb">`</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">((</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nv">rtn</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%0.3f&quot;</span><span class="w"> </span><span class="sb">`</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$now</span><span class="w"> </span>-<span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>bc<span class="sb">`</span><span class="k">)</span><span class="p">;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nv">rtn</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%0.3f&quot;</span><span class="w"> </span><span class="sb">`</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$now</span><span class="sb">`</span><span class="k">)</span><span class="p">;</span>
<span class="w">    </span><span class="k">fi</span><span class="p">;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$rtn</span>
<span class="o">}</span>

printenv<span class="w"> </span>&gt;<span class="w"> </span>env-<span class="nv">$SLURM_JOB_ID</span>.out
cat<span class="w"> </span><span class="nv">$0</span><span class="w"> </span>&gt;<span class="w"> </span>script-<span class="nv">$SLURM_JOB_ID</span>.out

<span class="c1">#runs script to put our restore function in our environment</span>
.<span class="w"> </span>whack.sh
module_restore

<span class="c1">#some possible values for gcc module</span>
<span class="c1">#export MYGCC=gcc-native/12.1</span>
<span class="c1">#export MYGCC=gcc-stdalone/10.1.0</span>
<span class="c1">#export MYGCC=gcc-stdalone/12.3.0 </span>
<span class="c1">#export MYGCC=gcc-stdalone/13.1.0</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">MYGCC</span><span class="o">=</span>gcc-native/12.1<span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>MYGCC<span class="w"> </span>already<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">MYGCC</span><span class="o">=</span><span class="nv">$MYGCC</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">doits</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>
<span class="w">    </span><span class="nv">doits</span><span class="o">=</span><span class="sb">`</span>find<span class="w"> </span>.<span class="w"> </span>-name<span class="w"> </span>doit<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-t/<span class="w"> </span>-k2,2<span class="sb">`</span>
<span class="k">else</span><span class="w"> </span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>doits<span class="w"> </span>already<span class="w"> </span><span class="nb">set</span><span class="w"> </span>
<span class="k">fi</span>

<span class="k">for</span><span class="w"> </span>x<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$doits</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>example<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>dirname<span class="w"> </span><span class="nv">$x</span><span class="sb">`</span>
<span class="k">done</span>

<span class="nv">startdir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="nv">t1</span><span class="o">=</span><span class="sb">`</span>dt<span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>x<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$doits</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w"> </span><span class="nv">dir</span><span class="o">=</span><span class="sb">`</span>dirname<span class="w"> </span><span class="nv">$x</span><span class="sb">`</span>
<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>++++++++<span class="w"> </span><span class="nv">$dir</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>&gt;<span class="o">(</span>cat<span class="w"> </span><span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span><span class="o">)</span>
<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$dir</span>
<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$dir</span>
<span class="w"> </span><span class="nv">tbegin</span><span class="o">=</span><span class="sb">`</span>dt<span class="sb">`</span>
<span class="w"> </span>.<span class="w"> </span>doit<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w">  </span><span class="nv">$SLURM_JOB_ID</span>
<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>Runtime<span class="w"> </span><span class="sb">`</span>dt<span class="w"> </span><span class="nv">$tbegin</span><span class="sb">`</span><span class="w"> </span><span class="nv">$dir</span><span class="w"> </span><span class="sb">`</span>dt<span class="w"> </span><span class="nv">$t1</span><span class="sb">`</span><span class="w"> </span>total<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>&gt;<span class="o">(</span>cat<span class="w"> </span><span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span><span class="o">)</span>
<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$startdir</span>
<span class="k">done</span>
<span class="nb">echo</span><span class="w"> </span>FINISHED<span class="w"> </span><span class="sb">`</span>dt<span class="w"> </span><span class="nv">$t1</span><span class="sb">`</span>

<span class="c1"># post  (this is optional)</span>
mkdir<span class="w"> </span>-p<span class="w"> </span>/scratch/<span class="nv">$USER</span>/gputest/<span class="nv">$SLURM_JOB_ID</span>
cp<span class="w"> </span>*out<span class="w">  </span>/scratch/<span class="nv">$USER</span>/gputest/<span class="nv">$SLURM_JOB_ID</span>
<span class="c1"># . cleanup</span>

<span class="w">    </span><span class="sb">```</span>


<span class="c1">## cuda/cray</span>
Here<span class="w"> </span>we<span class="w"> </span>build<span class="w"> </span>and<span class="w"> </span>run<span class="w"> </span>a<span class="w"> </span>single<span class="w"> </span>GPU<span class="w"> </span>code<span class="w"> </span>stream.cu.<span class="w">  </span>This<span class="w"> </span>code<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>standard<span class="w"> </span>benchmark<span class="w"> </span>that<span class="w"> </span>measures<span class="w"> </span>the<span class="w"> </span>floating<span class="w"> </span>point<span class="w"> </span>performance<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>GPU.

In<span class="w"> </span>this<span class="w"> </span><span class="k">case</span><span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>loading<span class="w"> </span>PrgEnv-nvhpc/8.4.0<span class="w"> </span>which<span class="w"> </span>requires<span class="w"> </span>cray-libsci/23.05.1.4.<span class="w">  </span>We<span class="w"> </span>compile<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span><span class="s2">&quot;wrapper&quot;</span><span class="w"> </span>compiler<span class="w"> </span>CC<span class="w"> </span>which,<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span><span class="k">case</span><span class="w"> </span>builds<span class="w"> </span>with<span class="w"> </span>NVIDIA<span class="s1">&#39;s backend compiler.  CC would &quot;pull in&quot; Cray&#39;</span>s<span class="w"> </span>MPI<span class="w"> </span>it<span class="w"> </span>it<span class="w"> </span>was<span class="w"> </span>required.

We<span class="w"> </span>run<span class="w"> </span>on<span class="w"> </span>each<span class="w"> </span>GPU<span class="w"> </span>of<span class="w"> </span>each<span class="w"> </span>Node<span class="w"> </span><span class="k">in</span><span class="w"> </span>our<span class="w"> </span>allocation.

???<span class="w"> </span>example<span class="w"> </span><span class="s2">&quot;cuda/cray&quot;</span>
<span class="w">    </span><span class="sb">```</span>bash
<span class="w">    </span>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
<span class="w">    </span>module_restore

<span class="w">    </span>:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="w">    </span><span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="w">    </span><span class="c1">#module unload nvhpc/24.1</span>


<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<span class="w">    </span>ml<span class="w"> </span>PrgEnv-nvhpc/8.4.0
<span class="w">    </span>ml<span class="w"> </span>cray-libsci/23.05.1.4
<span class="w">    </span>ml<span class="w"> </span>binutils
<span class="w">    </span>:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w">     </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w">     </span>CC<span class="w"> </span>as<span class="w"> </span>well<span class="w"> </span>as<span class="w"> </span>cc,<span class="w"> </span>and<span class="w"> </span>ftn<span class="w"> </span>are<span class="w"> </span>wrapper<span class="w"> </span>compilers.<span class="w"> </span>Because
<span class="w">     </span>we<span class="w"> </span>have<span class="w"> </span>PrgEnv-nvidia<span class="w"> </span>loaded<span class="w"> </span>they<span class="w"> </span>map<span class="w"> </span>to<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>compilers
<span class="w">     </span>but<span class="w"> </span>use<span class="w"> </span>would<span class="w"> </span>use<span class="w"> </span>Cray<span class="w"> </span>MPI<span class="w"> </span><span class="k">if</span><span class="w"> </span>this<span class="w"> </span>was<span class="w"> </span>an<span class="w"> </span>MPI<span class="w"> </span>program.
<span class="w">     </span>Note<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>also<span class="w"> </span>use<span class="w"> </span>nvcc<span class="w"> </span>since<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>an<span class="w"> </span>MPI<span class="w"> </span>program.
<span class="w">    </span>++++

<span class="w">    </span>rm<span class="w"> </span>-rf<span class="w"> </span>./stream.sm_90
<span class="w">    </span>CC<span class="w"> </span>-gpu<span class="o">=</span>cc90<span class="w">  </span>-cuda<span class="w"> </span>-target-accel<span class="o">=</span>nvidia90<span class="w">  </span>stream.cu<span class="w">  </span>-o<span class="w"> </span>stream.sm_90
<span class="w">    </span><span class="c1"># nvcc -std=c++11 -ccbin=g++ stream.cu -arch=sm_90 -o stream.sm_90</span>

<span class="w">    </span>:<span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>all<span class="w"> </span>of<span class="w"> </span>our<span class="w"> </span>nodes
<span class="w">    </span><span class="nv">nlist</span><span class="o">=</span><span class="sb">`</span>scontrol<span class="w"> </span>show<span class="w"> </span>hostnames<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="sb">`</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>l<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$nlist</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w">   </span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$l</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span>GPU<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span>:<span class="w"> </span>stream.cu<span class="w"> </span>will<span class="w"> </span><span class="nb">read</span><span class="w"> </span>the<span class="w"> </span>GPU<span class="w"> </span>on<span class="w"> </span>which<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span><span class="nb">command</span><span class="w"> </span>line
<span class="w">          </span>srun<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>-w<span class="w"> </span><span class="nv">$l</span><span class="w"> </span>./stream.sm_90<span class="w"> </span>-g<span class="w"> </span><span class="nv">$GPU</span>
<span class="w">      </span><span class="k">done</span>
<span class="w">      </span><span class="nb">echo</span>
<span class="w">    </span><span class="k">done</span>
</code></pre></div>
</details>
<h2 id="cudagccalso">cuda/gccalso<a class="headerlink" href="#cudagccalso" title="Permanent link">#</a></h2>
<p>Here we build and run a single GPU code stream.cu. This code is a standard benchmark that measures the floating point performance for a GPU.  In this case we break the compile into two parts; compiling the "normal" C portions with gcc and the Cuda portions with compilers enabled via the load nvhpc-nompi.  This is NVIDIA's compilers without MPI.</p>
<details class="example">
<summary>cuda/gccalso</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload  PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>nvhpc-nompi/24.1
ml<span class="w"> </span>binutils

ml<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>gcc-stdalone/13.1.0<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>REPLACING<span class="w"> </span>gcc-stdalone/13.1.0<span class="w"> </span><span class="p">;</span><span class="w"> </span>ml<span class="w"> </span>gcc-stdalone/12.3.0<span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>The<span class="w"> </span>module<span class="w"> </span>nvhpc-nompi<span class="w"> </span>gives<span class="w"> </span>us<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>compilers
<span class="w"> </span>nvc,<span class="w"> </span>nvc++,<span class="w"> </span>nvcc,<span class="w"> </span>nvfortran<span class="w"> </span>as<span class="w"> </span>well<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>Portland<span class="w"> </span>Group<span class="w"> </span>
<span class="w"> </span>compilers<span class="w"> </span>which<span class="w"> </span>are<span class="w"> </span>actually<span class="w"> </span>links<span class="w"> </span>to<span class="w"> </span>these.<span class="w">  </span>We<span class="w"> </span><span class="k">do</span><span class="w"> </span>not
<span class="w"> </span>have<span class="w"> </span>direct<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>MPI<span class="w"> </span>with<span class="w"> </span>this<span class="w"> </span><span class="nb">set</span><span class="w"> </span>of<span class="w"> </span>modules<span class="w"> </span>loaded.
<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>compile<span class="w"> </span>routines<span class="w"> </span>that<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>containe<span class="w"> </span>cuda<span class="w"> </span>with<span class="w"> </span>g++.
++++


g++<span class="w"> </span>-c<span class="w"> </span>normal.c<span class="w"> </span>
nvcc<span class="w"> </span>-std<span class="o">=</span>c++11<span class="w"> </span>-arch<span class="o">=</span>sm_90<span class="w"> </span>cuda.cu<span class="w"> </span>normal.o<span class="w"> </span>-o<span class="w"> </span>stream.sm_90

:<span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>all<span class="w"> </span>of<span class="w"> </span>our<span class="w"> </span>nodes
<span class="nv">nlist</span><span class="o">=</span><span class="sb">`</span>scontrol<span class="w"> </span>show<span class="w"> </span>hostnames<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>l<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$nlist</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w">   </span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$l</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span>GPU<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
:<span class="w"> </span>stream.cu<span class="w"> </span>will<span class="w"> </span><span class="nb">read</span><span class="w"> </span>the<span class="w"> </span>GPU<span class="w"> </span>on<span class="w"> </span>which<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span><span class="nb">command</span><span class="w"> </span>line
<span class="w">      </span>srun<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>-w<span class="w"> </span><span class="nv">$l</span><span class="w"> </span>./stream.sm_90<span class="w"> </span>-g<span class="w"> </span><span class="nv">$GPU</span>
<span class="w">  </span><span class="k">done</span>
<span class="w">  </span><span class="nb">echo</span>
<span class="k">done</span>
</code></pre></div>
</details>
<h2 id="cudanvidia">cuda/nvidia<a class="headerlink" href="#cudanvidia" title="Permanent link">#</a></h2>
<p>Steam.cu runs a standard benchmark showing the computational speed of the gpu for simple math operations.</p>
<p>We use nvhpc-nompi which is a NREL written environment that builds cuda programs without MPI and run on each of the GPUs one at a time.</p>
<details class="example">
<summary>cuda/nvidia</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload  PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

ml<span class="w"> </span>nvhpc-nompi/24.1
:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>The<span class="w"> </span>module<span class="w"> </span>nvhpc-nompi<span class="w"> </span>gives<span class="w"> </span>us<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>compilers
<span class="w"> </span>nvc,<span class="w"> </span>nvc++,<span class="w"> </span>nvcc,<span class="w"> </span>nvfortran<span class="w"> </span>as<span class="w"> </span>well<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>Portland<span class="w"> </span>Group<span class="w"> </span>
<span class="w"> </span>compilers<span class="w"> </span>which<span class="w"> </span>are<span class="w"> </span>actually<span class="w"> </span>links<span class="w"> </span>to<span class="w"> </span>these.<span class="w">  </span>We<span class="w"> </span><span class="k">do</span><span class="w"> </span>not
<span class="w"> </span>have<span class="w"> </span>direct<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>MPI<span class="w"> </span>with<span class="w"> </span>this<span class="w"> </span><span class="nb">set</span><span class="w"> </span>of<span class="w"> </span>modules<span class="w"> </span>loaded.
++++


nvcc<span class="w"> </span>-std<span class="o">=</span>c++11<span class="w"> </span>-arch<span class="o">=</span>sm_90<span class="w"> </span>stream.cu<span class="w"> </span>-o<span class="w"> </span>stream.sm_90

:<span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>all<span class="w"> </span>of<span class="w"> </span>our<span class="w"> </span>nodes
<span class="nv">nlist</span><span class="o">=</span><span class="sb">`</span>scontrol<span class="w"> </span>show<span class="w"> </span>hostnames<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>l<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$nlist</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w">   </span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$l</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span>GPU<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
:<span class="w"> </span>stream.cu<span class="w"> </span>will<span class="w"> </span><span class="nb">read</span><span class="w"> </span>the<span class="w"> </span>GPU<span class="w"> </span>on<span class="w"> </span>which<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span><span class="nb">command</span><span class="w"> </span>line
<span class="w">      </span>srun<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>-w<span class="w"> </span><span class="nv">$l</span><span class="w"> </span>./stream.sm_90<span class="w"> </span>-g<span class="w"> </span><span class="nv">$GPU</span>
<span class="w">  </span><span class="k">done</span>
<span class="w">  </span><span class="nb">echo</span>
<span class="k">done</span>
</code></pre></div>
</details>
<h2 id="mpinormalcray">mpi/normal/cray<a class="headerlink" href="#mpinormalcray" title="Permanent link">#</a></h2>
<p>We are building MPI programs that do not contain Cuda.  We unload nvhpc and load an older version to prevent compile issues.  We need to load cuda because Cray's MPI expects it, even for nonCuda programs.  We compile with ftn and cc which are "replacements" for the more traditional mpicc and mpifort.  These will pull in MPI as needed.  These should be used for codes even if they don't contain MPI.  Parallel programs built with PrgEnv-* should be launched with srun as shown here.</p>
<details class="example">
<summary>mpi/normal/cray</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore


:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload nvhpc/24.1</span>
ml<span class="w"> </span>PrgEnv-cray/8.4.0<span class="w"> </span>

ml<span class="w"> </span>cuda
:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program.

<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>cc<span class="w"> </span>and<span class="w"> </span>ftn.<span class="w">  </span>These<span class="w"> </span>are<span class="w"> </span>wrappers
<span class="w"> </span>that<span class="w"> </span>point<span class="w"> </span>to<span class="w"> </span>Cray<span class="w"> </span>C<span class="w"> </span><span class="o">(</span>clang<span class="o">)</span><span class="w"> </span>Cray<span class="w"> </span>Fortran
<span class="w"> </span>and<span class="w"> </span>Cray<span class="w"> </span>MPI.<span class="w"> </span>cc<span class="w"> </span>and<span class="w"> </span>ftn<span class="w"> </span>are<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>PrgEnv-cray
<span class="w"> </span>with<span class="w"> </span>is<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>setup.
++++

cc<span class="w"> </span>helloc.c<span class="w"> </span>-o<span class="w"> </span>helloc
ftn<span class="w"> </span>hellof.f90<span class="w"> </span>-o<span class="w"> </span>hellof

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes<span class="w"> </span>an<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>on<span class="w"> </span>one<span class="w"> </span>node.
<span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;--tasks-per-node=2&quot;</span><span class="w"> </span><span class="s2">&quot;-n 2 --nodes=1&quot;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>Fortran<span class="w"> </span>version
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>hellof
<span class="w">   </span><span class="nb">echo</span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>C<span class="w"> </span>version
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>helloc
<span class="w">   </span><span class="nb">echo</span>
<span class="k">done</span>

:<span class="w"> </span>With<span class="w"> </span>PrgEnv-intel<span class="w"> </span>we<span class="w"> </span>get<span class="w"> </span>the<span class="w"> </span>Intel<span class="w"> </span>backend<span class="w"> </span>compilers
ml<span class="w"> </span>PrgEnv-intel
ml<span class="w"> </span>cray-libsci/23.05.1.4
<span class="c1">#ml gcc-stdalone/13.1.0</span>
ml<span class="w"> </span>binutils

cc<span class="w"> </span>helloc.c<span class="w"> </span>-o<span class="w"> </span>helloc.i
ftn<span class="w"> </span>hellof.f90<span class="w"> </span>-o<span class="w"> </span>hellof.i

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes<span class="w"> </span>an<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>on<span class="w"> </span>one<span class="w"> </span>node.
<span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;--tasks-per-node=2&quot;</span><span class="w"> </span><span class="s2">&quot;-n 2 --nodes=1&quot;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>Fortran<span class="w"> </span>version<span class="w"> </span>with<span class="w"> </span>Intel<span class="w"> </span>backend
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>hellof.i
<span class="w">   </span><span class="nb">echo</span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>C<span class="w"> </span>version<span class="w"> </span>with<span class="w"> </span>Intel<span class="w"> </span>backend
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>helloc.i
<span class="w">   </span><span class="nb">echo</span>
<span class="k">done</span>

:<span class="w"> </span>With<span class="w"> </span>PrgEnv-gnu<span class="w"> </span>we<span class="w"> </span>get<span class="w"> </span>the<span class="w"> </span>gnu<span class="w"> </span>backend<span class="w"> </span>compilers
:<span class="w"> </span>As<span class="w"> </span>of<span class="w"> </span><span class="m">04</span>/04/24<span class="w"> </span>the<span class="w"> </span>-march<span class="o">=</span>znver3<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>required
:<span class="w"> </span>because<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>gcc<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>the
:<span class="w"> </span>current<span class="w"> </span>CPU<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>GPU<span class="w"> </span>nodes.<span class="w">  </span>Or<span class="w"> </span>you<span class="w"> </span>could
:<span class="w"> </span>ml<span class="w"> </span>craype-x86-milan
ml<span class="w"> </span>PrgEnv-gnu
ml<span class="w"> </span>cray-libsci/23.05.1.4
cc<span class="w">  </span>-march<span class="o">=</span>znver3<span class="w"> </span>helloc.c<span class="w"> </span>-o<span class="w"> </span>helloc.g
ftn<span class="w"> </span>-march<span class="o">=</span>znver3<span class="w"> </span>hellof.f90<span class="w"> </span>-o<span class="w"> </span>hellof.g

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes<span class="w"> </span>an<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>on<span class="w"> </span>one<span class="w"> </span>node.
<span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;--tasks-per-node=2&quot;</span><span class="w"> </span><span class="s2">&quot;-n 2 --nodes=1&quot;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>Fortran<span class="w"> </span>version<span class="w"> </span>with<span class="w"> </span>gnu<span class="w"> </span>backend
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>hellof.g
<span class="w">   </span><span class="nb">echo</span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>C<span class="w"> </span>version<span class="w"> </span>with<span class="w"> </span>gnu<span class="w"> </span>backend
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>helloc.g
<span class="w">   </span><span class="nb">echo</span>
<span class="k">done</span>
</code></pre></div>
</details>
<h2 id="mpinormalintelabi">mpi/normal/intel+abi<a class="headerlink" href="#mpinormalintelabi" title="Permanent link">#</a></h2>
<p>In this case we are building hello world using Intel's compilers and Intel's MPI.  We load the intel-onapi-{mpi,compilers} modules and build with mpiicx and and mpifc.</p>
<p>These hello world programs will report the version of the MPI library used.  The report they are using Intel MPI.</p>
<p>However, if we load the modules craype and cray-mpich-abi the Intel MPI library gets replaced with Cray MPI at runtime.  This is reported in the program output.  the advantage is better performance for off node communication.  Cray-mpich-abi will not work if the program contains C++ MPI calls but will work if C++ calls normal C MPI routines as dictated by the standard.</p>
<details class="example">
<summary>mpi/normal/intel+abi</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>intel-oneapi-mpi
ml<span class="w"> </span>intel-oneapi-compilers
ml<span class="w"> </span>binutils

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program.

<span class="w"> </span>There<span class="w"> </span>are<span class="w"> </span>many<span class="w"> </span>ways<span class="w"> </span>to<span class="w"> </span>compile<span class="w"> </span>using<span class="w"> </span>Intel<span class="w"> </span>MPI.
<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>the<span class="w"> </span><span class="s2">&quot;Intel Suggested&quot;</span><span class="w"> </span>way<span class="w"> </span>using<span class="w"> </span>mpiicx
<span class="w"> </span>and<span class="w"> </span>mpifc.<span class="w">  </span>This<span class="w"> </span>gives<span class="w"> </span>us<span class="w"> </span>new<span class="w"> </span>Intel<span class="w"> </span>backend<span class="w"> </span>compilers
<span class="w"> </span>with<span class="w"> </span>Intel<span class="w"> </span>MPI.<span class="w"> </span>mpif90<span class="w"> </span>and<span class="w"> </span>mpicc<span class="w"> </span>would<span class="w"> </span>give<span class="w"> </span>us<span class="w"> </span>gcc
<span class="w"> </span>and<span class="w"> </span>gfortan<span class="w"> </span>instead
++++

mpiicx<span class="w"> </span>helloc.c<span class="w"> </span>-o<span class="w"> </span>helloc
mpifc<span class="w"> </span>hellof.f90<span class="w"> </span>-o<span class="w"> </span>hellof

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes<span class="w"> </span>an<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>on<span class="w"> </span>one<span class="w"> </span>node.
<span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;--tasks-per-node=2&quot;</span><span class="w"> </span><span class="s2">&quot;-n 2 --nodes=1&quot;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>Fortran<span class="w"> </span>version
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>hellof
<span class="w">   </span><span class="nb">echo</span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>C<span class="w"> </span>version
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>helloc
<span class="w">   </span><span class="nb">echo</span>
<span class="k">done</span>

:<span class="w"> </span>Finally<span class="w"> </span>we<span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>cray-mpich-abi.<span class="w">  </span>With<span class="w"> </span>this<span class="w"> </span>module
:<span class="w"> </span>loaded<span class="w"> </span>Intel<span class="w"> </span>MPI<span class="w"> </span>is<span class="w"> </span>replaced<span class="w"> </span>with<span class="w"> </span>Cray<span class="w"> </span>MPI<span class="w"> </span>without<span class="w"> </span>needing
:<span class="w"> </span>to<span class="w"> </span>recompile.<span class="w"> </span>After<span class="w"> </span>the<span class="w"> </span>load<span class="w"> </span>we<span class="w"> </span>rerun<span class="w"> </span>and<span class="w"> </span>see<span class="w"> </span>Cray<span class="w"> </span>MPI
:<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>output

ml<span class="w"> </span>craype
ml<span class="w"> </span>cray-mpich-abi

<span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;--tasks-per-node=2&quot;</span><span class="w"> </span><span class="s2">&quot;-n 2 --nodes=1&quot;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>Fortran<span class="w"> </span>version
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>hellof
<span class="w">   </span><span class="nb">echo</span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>C<span class="w"> </span>version
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>helloc
<span class="w">   </span><span class="nb">echo</span>
<span class="k">done</span>
</code></pre></div>
</details>
<h2 id="mpinormalnvidianrelopenmpi">mpi/normal/nvidia/nrelopenmpi<a class="headerlink" href="#mpinormalnvidianrelopenmpi" title="Permanent link">#</a></h2>
<p>In this case we are building normal MPI programs but using a NREL built OpenMPI and a NREL installed version of NVIDIA's environment.  This particular OpenMPI was built using NVIDIA's compilers and thus is more compatible with other NVIDIA packages.  NREL's MPI versions are built with slurm support so these programs are launched with srun.</p>
<details class="example">
<summary>mpi/normal/nvidia/nrelopenmpi</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>openmpi/4.1.6-nvhpc
ml<span class="w"> </span>nvhpc-nompi/24.1
ml<span class="w"> </span>binutils

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpicc<span class="w"> </span>and<span class="w"> </span>mpif90.<span class="w">  </span>There<span class="w"> </span>is<span class="w"> </span>support<span class="w"> </span><span class="k">for</span><span class="w"> </span>Cuda
<span class="w"> </span>but<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>using<span class="w"> </span>it<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span><span class="k">case</span>.
++++

mpicc<span class="w"> </span>helloc.c<span class="w"> </span>-o<span class="w"> </span>helloc
mpif90<span class="w"> </span>hellof.f90<span class="w"> </span>-o<span class="w"> </span>hellof

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes<span class="w"> </span>an<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>on<span class="w"> </span>one<span class="w"> </span>node.
<span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;--tasks-per-node=2&quot;</span><span class="w"> </span><span class="s2">&quot;-n 2 --nodes=1&quot;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>Fortran<span class="w"> </span>version
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>hellof
<span class="w">   </span><span class="nb">echo</span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>C<span class="w"> </span>version
<span class="w">   </span>srun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>helloc
<span class="w">   </span><span class="nb">echo</span>
<span class="k">done</span>
</code></pre></div>
</details>
<h2 id="mpinormalnvidianvidiaopenmpi">mpi/normal/nvidia/nvidiaopenmpi<a class="headerlink" href="#mpinormalnvidianvidiaopenmpi" title="Permanent link">#</a></h2>
<p>In this case we are building normal MPI programs but using a nvhpc/24.1.  This particular MPI was built using NVIDIA's compilers and thus is more compatible with other NVIDIA packages.  This version of MPI does not support slurm's srun command so we launch with mpirun.</p>
<details class="example">
<summary>mpi/normal/nvidia/nvidiaopenmpi</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w">  </span>nvhpc-stdalone/24.1

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpicc<span class="w"> </span>and<span class="w"> </span>mpif90.<span class="w">  </span>There<span class="w"> </span>is<span class="w"> </span>support<span class="w"> </span><span class="k">for</span><span class="w"> </span>Cuda
<span class="w"> </span>but<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>using<span class="w"> </span>it<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span><span class="k">case</span>.
++++

mpicc<span class="w"> </span>helloc.c<span class="w"> </span>-o<span class="w"> </span>helloc
mpif90<span class="w"> </span>hellof.f90<span class="w"> </span>-o<span class="w"> </span>hellof

:<span class="w"> </span>This<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>MPI<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>srun<span class="w"> </span>so<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpirun
:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes<span class="w"> </span>an<span class="w"> </span>two<span class="w"> </span>tasks<span class="w"> </span>on<span class="w"> </span>one<span class="w"> </span>node.
<span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;-N 2&quot;</span><span class="w"> </span><span class="s2">&quot;-n 2&quot;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>Fortran<span class="w"> </span>version
<span class="w">   </span>mpirun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>hellof
<span class="w">   </span><span class="nb">echo</span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>C<span class="w"> </span>version
<span class="w">   </span>mpirun<span class="w"> </span><span class="nv">$arg</span><span class="w"> </span>helloc
<span class="w">   </span><span class="nb">echo</span>
<span class="k">done</span>
</code></pre></div>
</details>
<h2 id="mpiwithcudacray">mpi/withcuda/cray<a class="headerlink" href="#mpiwithcudacray" title="Permanent link">#</a></h2>
<p>This example is a MPI ping-pong test where the data starts and ends up on a GPU but passes through CPU memory. Here are the Cuda copy routines and MPI routines. d_A is a GPU (device) array.  It is copied to/from A a CPU array using cudaMemcpy.  A is sent/received via the MPI calls.</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="o">(</span>int<span class="w"> </span><span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="w"> </span>i&lt;<span class="o">=</span>loop_count<span class="p">;</span><span class="w"> </span>i++<span class="o">){</span>
<span class="w">    </span><span class="k">if</span><span class="o">(</span><span class="nv">rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="o">){</span>
<span class="w">        </span>cudaMemcpy<span class="o">(</span>A,<span class="w"> </span>d_A,<span class="w"> </span>N*sizeof<span class="o">(</span>double<span class="o">)</span>,<span class="w"> </span>cudaMemcpyDeviceToHost<span class="o">)</span><span class="w"> </span><span class="p">;</span>
<span class="w">        </span>MPI_Send<span class="o">(</span>A,<span class="w"> </span>N,<span class="w"> </span>MPI_DOUBLE,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>tag1,<span class="w"> </span>MPI_COMM_WORLD<span class="o">)</span><span class="p">;</span>
<span class="w">        </span>MPI_Recv<span class="o">(</span>A,<span class="w"> </span>N,<span class="w"> </span>MPI_DOUBLE,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>tag2,<span class="w"> </span>MPI_COMM_WORLD,<span class="w"> </span><span class="p">&amp;</span>stat<span class="o">)</span><span class="p">;</span>
<span class="w">        </span>cudaMemcpy<span class="o">(</span>d_A,<span class="w"> </span>A,<span class="w"> </span>N*sizeof<span class="o">(</span>double<span class="o">)</span>,<span class="w"> </span>cudaMemcpyHostToDevice<span class="o">)</span><span class="w"> </span><span class="p">;</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="o">(</span><span class="nv">rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="o">){</span>
<span class="w">        </span>MPI_Recv<span class="o">(</span>A,<span class="w"> </span>N,<span class="w"> </span>MPI_DOUBLE,<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>tag1,<span class="w"> </span>MPI_COMM_WORLD,<span class="w"> </span><span class="p">&amp;</span>stat<span class="o">)</span><span class="p">;</span>
<span class="w">        </span>cudaMemcpy<span class="o">(</span>d_A,<span class="w"> </span>A,<span class="w"> </span>N*sizeof<span class="o">(</span>double<span class="o">)</span>,<span class="w"> </span>cudaMemcpyHostToDevice<span class="o">)</span><span class="w"> </span><span class="p">;</span>
<span class="w">        </span>cudaMemcpy<span class="o">(</span>A,<span class="w"> </span>d_A,<span class="w"> </span>N*sizeof<span class="o">(</span>double<span class="o">)</span>,<span class="w"> </span>cudaMemcpyDeviceToHost<span class="o">)</span><span class="w"> </span><span class="p">;</span>
<span class="w">        </span>MPI_Send<span class="o">(</span>A,<span class="w"> </span>N,<span class="w"> </span>MPI_DOUBLE,<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>tag2,<span class="w"> </span>MPI_COMM_WORLD<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>We are using PrgEnv-nvhpc which combines Cray MPI and NVIDIA's back end compilers.  As of the date of this writing this version of with NVIDIA's compilers are not compatible with GCC 13.  So we test to see if it is loaded and replace it as needed.</p>
<p>Here we use CC. If we were compiling Fortran then ftn instead of CC.  These are wrappers that point to Cray MPI.</p>
<p>We also build and run a multi-GPU version of stream which measures numerical performance of the GPU Stream is run simultaneously on all GPUs.  This code can test that can be run to test if a GPU is running properly.  </p>
<p>Since PrgEnv-* is compatible with slurm we launch using srun. We do a on-node and off-node test.</p>
<details class="example">
<summary>mpi/withcuda/cray</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

ml<span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<span class="c1">#######</span>
ml<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>gcc-native/12.1<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>REPLACING<span class="w"> </span>gcc-native/12.1<span class="w"> </span><span class="p">;</span><span class="w"> </span>ml<span class="w"> </span>gcc-stdalone/13.1.0<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<span class="c1">#######</span>
ml<span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>

ml<span class="w"> </span>PrgEnv-nvhpc
ml<span class="w"> </span>cray-libsci/23.05.1.4
ml<span class="w"> </span>binutils
:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program.

<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>CC.<span class="w"> </span>If<span class="w"> </span>we<span class="w"> </span>were<span class="w"> </span>compiling<span class="w"> </span>Fortran
<span class="w"> </span><span class="k">then</span><span class="w"> </span>ftn<span class="w"> </span>instead<span class="w"> </span>of<span class="w"> </span>CC.<span class="w">  </span>These<span class="w"> </span>are<span class="w"> </span>wrappers
<span class="w"> </span>that<span class="w"> </span>point<span class="w"> </span>to<span class="w"> </span>Cray<span class="w"> </span>MPI<span class="w"> </span>and<span class="w"> </span>with<span class="w"> </span>PrgEnv-nvhpc
<span class="w"> </span>we<span class="w"> </span>get<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>back<span class="w"> </span>end<span class="w"> </span>compilers.<span class="w">  </span>
++++

CC<span class="w"> </span>-gpu<span class="o">=</span>cc90<span class="w">   </span>ping_pong_cuda_staged.cu<span class="w"> </span>-o<span class="w"> </span>staged


:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span><span class="m">2</span><span class="w"> </span>tasks<span class="w"> </span>total.<span class="w"> </span>One<span class="w"> </span><span class="m">1</span><span class="w"> </span>and<span class="w"> </span>two<span class="w"> </span>nodes
<span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>staged<span class="w"> </span>on<span class="w"> </span>node
srun<span class="w">  </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--tasks-per-node<span class="o">=</span><span class="m">2</span><span class="w"> </span>./staged

<span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>staged<span class="w"> </span>off<span class="w"> </span>node
srun<span class="w">  </span>--nodes<span class="o">=</span><span class="m">2</span><span class="w"> </span>--tasks-per-node<span class="o">=</span><span class="m">1</span><span class="w"> </span>./staged

<span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>multi-gpu<span class="w"> </span>stream
CC<span class="w"> </span>-gpu<span class="o">=</span>cc90<span class="w">  </span>-DNTIMES<span class="o">=</span><span class="m">1000</span><span class="w">  </span>mstream.cu<span class="w"> </span>-o<span class="w"> </span>mstream
<span class="nb">export</span><span class="w"> </span><span class="nv">VSIZE</span><span class="o">=</span><span class="m">3300000000</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">VSIZE</span><span class="o">=</span><span class="m">330000000</span>
srun<span class="w"> </span>--tasks-per-node<span class="o">=</span><span class="m">4</span><span class="w">  </span>./mstream<span class="w"> </span>-n<span class="w"> </span><span class="nv">$VSIZE</span>
</code></pre></div>
</details>
<h2 id="mpiwithcudanvidianrelopenmpi">mpi/withcuda/nvidia/nrelopenmpi<a class="headerlink" href="#mpiwithcudanvidianrelopenmpi" title="Permanent link">#</a></h2>
<p>This example is a MPI ping-pong test where the data starts and ends up on a GPU but passes through CPU memory.  See the explanation in the previous example.</p>
<p>We are using ml openmpi/4.1.6-nvhpc and ml nvhpc-nompi/24.1.  These supply a NREL built version of OpenMPI with NVIDIA's backend compilers.</p>
<p>Here we use mpiCC. If we were compiling Fortran then ftn instead of CC.  These are wrappers that point to Cray MPI.</p>
<p>We also build and run a multi-GPU version of stream which measures numerical performance of the GPU Stream is run simultaneously on all GPUs.  This code cone test that can be run to test if a GPU is running properly.  </p>
<p>Since PrgEnv-* is compatible with slurm we launch using srun. We do a on-node and off-node test.</p>
<details class="example">
<summary>mpi/withcuda/nvidia/nrelopenmpi</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>openmpi/4.1.6-nvhpc
ml<span class="w"> </span>nvhpc-nompi/24.1
ml<span class="w"> </span>binutils

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpiCC<span class="w"> </span>which<span class="w"> </span>uses,<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span><span class="k">case</span><span class="w"> </span>a<span class="w"> </span>NREL<span class="w"> </span>built<span class="w">  </span>version
<span class="w"> </span>of<span class="w"> </span>MPI<span class="w"> </span>and<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>backend<span class="w"> </span>compiler.<span class="w"> </span>
++++

mpiCC<span class="w"> </span>ping_pong_cuda_staged.cu<span class="w"> </span>-o<span class="w"> </span>staged

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span><span class="m">2</span><span class="w"> </span>tasks<span class="w"> </span>total.
:<span class="w"> </span>This<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>MPI<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>srun<span class="w"> </span>so<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpirun

<span class="nb">echo</span><span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>single<span class="w"> </span>node
srun<span class="w"> </span>--tasks-per-node<span class="o">=</span><span class="m">2</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>./staged

<span class="nb">echo</span><span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>two<span class="w"> </span>nodes<span class="w"> </span>
srun<span class="w"> </span>--tasks-per-node<span class="o">=</span><span class="m">1</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">2</span><span class="w"> </span>./staged

<span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>multi-gpu<span class="w"> </span>stream
mpiCC<span class="w"> </span>-gpu<span class="o">=</span>cc90<span class="w">  </span>-DNTIMES<span class="o">=</span><span class="m">1000</span><span class="w">  </span>mstream.cu<span class="w"> </span>-o<span class="w"> </span>mstream
<span class="nb">export</span><span class="w"> </span><span class="nv">VSIZE</span><span class="o">=</span><span class="m">3300000000</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">VSIZE</span><span class="o">=</span><span class="m">330000000</span>
srun<span class="w"> </span>--tasks-per-node<span class="o">=</span><span class="m">4</span><span class="w">  </span>./mstream<span class="w"> </span>-n<span class="w"> </span><span class="nv">$VSIZE</span>
</code></pre></div>
</details>
<h2 id="mpiwithcudanvidianvidiaopenmpi">mpi/withcuda/nvidia/nvidiaopenmpi<a class="headerlink" href="#mpiwithcudanvidianvidiaopenmpi" title="Permanent link">#</a></h2>
<p>This example is a MPI ping-pong test where the data starts and ends up on a GPU but passes through CPU memory.  See the explanation two examples previous.</p>
<p>Here we use nvhpc/24.1.  (Note we actually unload this module and then reload it.  This is not actually necessary but is here for historical reasons.  In this case we could have just left it loaded.)</p>
<p>We compile with mpiCC.  Since NVIDIA's MPI does not support srun we launch with mpirun.  </p>
<details class="example">
<summary>mpi/withcuda/nvidia/nvidiaopenmpi</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>gcc-stdalone/13.1.0<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>REPLACING<span class="w"> </span>gcc-stdalone/13.1.0<span class="w"> </span><span class="p">;</span><span class="w"> </span>ml<span class="w"> </span>gcc-stdalone/12.3.0<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>

ml<span class="w"> </span>nvhpc-stdalone/24.1

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpiCC<span class="w"> </span>which<span class="w"> </span>uses<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>MPI<span class="w"> </span>and
<span class="w"> </span>their<span class="w"> </span>backend<span class="w"> </span>compiler.<span class="w"> </span>The<span class="w"> </span><span class="s2">&quot;hpcx&quot;</span><span class="w"> </span>has<span class="w"> </span>a<span class="w"> </span>few<span class="w"> </span>more<span class="w"> </span>optimizations.
++++

mpiCC<span class="w"> </span>ping_pong_cuda_staged.cu<span class="w"> </span>-o<span class="w"> </span>staged

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span><span class="m">2</span><span class="w"> </span>tasks<span class="w"> </span>total.
:<span class="w"> </span>This<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>MPI<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>srun<span class="w"> </span>so<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpirun

<span class="nb">echo</span><span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>single<span class="w"> </span>node
mpirun<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span>-N<span class="w"> </span><span class="m">2</span><span class="w"> </span>./staged

<span class="nb">echo</span><span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>two<span class="w"> </span>nodes<span class="w"> </span>
mpirun<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span>-N<span class="w"> </span><span class="m">1</span><span class="w"> </span>./staged


<span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>multi-gpu<span class="w"> </span>stream
mpiCC<span class="w"> </span>-gpu<span class="o">=</span>cc80<span class="w">  </span>-DNTIMES<span class="o">=</span><span class="m">1000</span><span class="w">  </span>mstream.cu<span class="w"> </span>-o<span class="w"> </span>mstream
<span class="nb">export</span><span class="w"> </span><span class="nv">VSIZE</span><span class="o">=</span><span class="m">3300000000</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">VSIZE</span><span class="o">=</span><span class="m">330000000</span>
mpirun<span class="w"> </span>-n<span class="w"> </span><span class="m">8</span><span class="w"> </span>-N<span class="w"> </span><span class="m">4</span><span class="w">  </span>./mstream<span class="w"> </span>-n<span class="w"> </span><span class="nv">$VSIZE</span>
</code></pre></div>
</details>
<h2 id="mpicudaaware">mpi/cudaaware<a class="headerlink" href="#mpicudaaware" title="Permanent link">#</a></h2>
<p>This example is a ping-pong test where the dat starts and ends up on a GPU. Unlike the previous three examples There is no explicit copy to/from the GPU and CPU.  Data is sent directly between GPUs.  The array d_A is a device array and is not defined on the CPU.  This is much faster than doing an explicit copy.  </p>
<p><div class="highlight"><pre><span></span><code><span class="k">for</span><span class="o">(</span>int<span class="w"> </span><span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="w"> </span>i&lt;<span class="o">=</span><span class="m">5</span><span class="p">;</span><span class="w"> </span>i++<span class="o">){</span>
<span class="w">    </span><span class="k">if</span><span class="o">(</span><span class="nv">rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="o">){</span>
<span class="w">        </span>MPI_Send<span class="o">(</span>d_A,<span class="w"> </span>N,<span class="w"> </span>MPI_DOUBLE,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>tag1,<span class="w"> </span>MPI_COMM_WORLD<span class="o">)</span><span class="p">;</span>
<span class="w">        </span>MPI_Recv<span class="o">(</span>d_A,<span class="w"> </span>N,<span class="w"> </span>MPI_DOUBLE,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>tag2,<span class="w"> </span>MPI_COMM_WORLD,<span class="w"> </span><span class="p">&amp;</span>stat<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="o">(</span><span class="nv">rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="o">){</span>
<span class="w">        </span>MPI_Recv<span class="o">(</span>d_A,<span class="w"> </span>N,<span class="w"> </span>MPI_DOUBLE,<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>tag1,<span class="w"> </span>MPI_COMM_WORLD,<span class="w"> </span><span class="p">&amp;</span>stat<span class="o">)</span><span class="p">;</span>
<span class="w">        </span>MPI_Send<span class="o">(</span>d_A,<span class="w"> </span>N,<span class="w"> </span>MPI_DOUBLE,<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>tag2,<span class="w"> </span>MPI_COMM_WORLD<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
Here we use PrgEnv-nvhpc and also need to load a specific version cray-libsci/23.05.1.4.</p>
<p>We need to  MPICH_GPU_SUPPORT_ENABLED=1 to make this work.  Depending on the code setting MPICH_OFI_NIC_POLICY=GPU may improve performance.</p>
<div class="highlight"><pre><span></span><code>??? example &quot;mpi/cudaaware&quot;
```bash
: Start from a known module state, the default
module_restore

: Load modules
#module unload nvhpc/24.1
#module unload PrgEnv-cray/8.5.0

if [ -z ${MYGCC+x} ]; then module load gcc ; else module load $MYGCC ; fi
ml PrgEnv-nvhpc
ml cray-libsci/23.05.1.4  
ml binutils

: &lt;&lt; ++++ 
 Compile our program.

 Here we use cc and CC.  These are wrappers
 that point to Cray MPI but use Nvidia backend 
 comilers.
++++

CC -gpu=cc90  -cuda -target-accel=nvidia90  -c ping_pong_cuda_aware.cu
cc -gpu=cc90  -cuda -target-accel=nvidia90 -lcudart -lcuda ping_pong_cuda_aware.o -o pp_cuda_aware

export MPICH_GPU_SUPPORT_ENABLED=1
export MPICH_OFI_NIC_POLICY=GPU
srun -n 2 --nodes=1 ./pp_cuda_aware
srun --tasks-per-node=1 --nodes=2 ./pp_cuda_aware
unset MPICH_GPU_SUPPORT_ENABLED
unset MPICH_OFI_NIC_POLICY

```
</code></pre></div>
<p>Here is a plot comparing the bandwidth using Staged and Cuda aware MPI.
<img alt="Bandwidth comparison between Staged and Aware MPI" src="../../../../../assets/images/bw.png" /></p>
<h2 id="openacccray">openacc/cray<a class="headerlink" href="#openacccray" title="Permanent link">#</a></h2>
<p>Here we run one of NVIDIA's examples.  It is a single GPU version nbody calculation.  It runs the same calculation on the CPU and the GPU and reports the difference in performance.</p>
<p>We are using PrgEnv-nvhpc/8.5.0 which gives us access to NVIDIA's compilers and Cray's MPI.  However, we don't use MPI.</p>
<p>We run on each GPU of each node in turn.  The variable CUDA_VISIBLE_DEVICES sets the GPU number.  </p>
<p>Since this is not a MPI program we don't actually need srun.  However, we use it in this case with the -w option to select the node on which we will launch the application.</p>
<details class="example">
<summary>openacc/cray</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>
module<span class="w"> </span>load<span class="w"> </span>binutils
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>PrgEnv-nvhpc/8.5.0


:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>The<span class="w"> </span>module<span class="w"> </span>PrgEnv-nvhpc/8.5.0<span class="w"> </span>gives<span class="w"> </span>us<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>
<span class="w"> </span>compilers<span class="w"> </span>nvc,<span class="w"> </span>nvc++,<span class="w"> </span>nvcc,<span class="w"> </span>nvfortran<span class="w"> </span>as<span class="w"> </span>well<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>Portland<span class="w"> </span>
<span class="w"> </span>Group<span class="w"> </span>compilers<span class="w"> </span>which<span class="w"> </span>are<span class="w"> </span>actually<span class="w"> </span>links<span class="w"> </span>to<span class="w"> </span>these.<span class="w">  </span>Since<span class="w"> </span>we<span class="w"> </span>
<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>using<span class="w"> </span>MPI<span class="w"> </span>we<span class="w"> </span>could<span class="w"> </span>have<span class="w"> </span>also<span class="w"> </span>used<span class="w"> </span>nvhpc-nompi/24.1<span class="w"> </span>or
<span class="w"> </span>even<span class="w"> </span>nvhpc-native/24.1.
++++


nvc<span class="w"> </span>-fast<span class="w"> </span>-Minline<span class="w"> </span>-Minfo<span class="w"> </span>-acc<span class="w"> </span>-DFP64<span class="w"> </span>nbodyacc2.c<span class="w"> </span>-o<span class="w"> </span>nbody



:<span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>all<span class="w"> </span>of<span class="w"> </span>our<span class="w"> </span>nodes
<span class="nv">nlist</span><span class="o">=</span><span class="sb">`</span>scontrol<span class="w"> </span>show<span class="w"> </span>hostnames<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>l<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$nlist</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w">   </span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$l</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span>GPU<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
:<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>one<span class="w"> </span>way<span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>the<span class="w"> </span>GPU<span class="w"> </span>on<span class="w"> </span>which<span class="w"> </span>a<span class="w"> </span>openacc<span class="w"> </span>program<span class="w"> </span>runs.
<span class="w">      </span><span class="nb">export</span><span class="w"> </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="nv">$GPU</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>on<span class="w"> </span>gpu<span class="w"> </span><span class="nv">$CUDA_VISIBLE_DEVICES</span>
:<span class="w"> </span>Since<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>running<span class="w"> </span>MPI<span class="w"> </span>we<span class="w"> </span>actaully<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>need<span class="w"> </span>srun<span class="w"> </span>here.
<span class="w">      </span>srun<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>-w<span class="w"> </span><span class="nv">$l</span><span class="w"> </span>./nbody
<span class="w">  </span><span class="k">done</span>
<span class="w">  </span><span class="nb">echo</span>
<span class="k">done</span>

<span class="nb">unset</span><span class="w"> </span>CUDA_VISIBLE_DEVICES
</code></pre></div>
</details>
<h2 id="openaccnvidia">openacc/nvidia<a class="headerlink" href="#openaccnvidia" title="Permanent link">#</a></h2>
<p>Here we run one of NVIDIA's examples.  It is a single GPU version nbody calculation.  It runs the same calculation on the CPU and the GPU and reports the difference in performance.</p>
<p>Here we use nvhpc which gives us access to NVIDIA's compilers.  We don't use MPI.</p>
<p>We run on each GPU of each node in turn.  The variable CUDA_VISIBLE_DEVICES sets the GPU number.  </p>
<p>Since this is not a MPI program we don't actually need srun.  However, we use it in this case with the -w option to select the node on which we will run.</p>
<details class="example">
<summary>openacc/nvidia</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>nvhpc-stdalone/24.1


:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>The<span class="w"> </span>module<span class="w"> </span>nvhpc-stdalone<span class="w"> </span>gives<span class="w"> </span>us<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>compilers
<span class="w"> </span>nvc,<span class="w"> </span>nvc++,<span class="w"> </span>nvcc,<span class="w"> </span>nvfortran<span class="w"> </span>as<span class="w"> </span>well<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>Portland<span class="w"> </span>Group<span class="w"> </span>
<span class="w"> </span>compilers<span class="w"> </span>which<span class="w"> </span>are<span class="w"> </span>actually<span class="w"> </span>links<span class="w"> </span>to<span class="w"> </span>these.<span class="w">  </span>Since<span class="w"> </span>we<span class="w"> </span>are
<span class="w"> </span>not<span class="w"> </span>using<span class="w"> </span>MPI<span class="w"> </span>we<span class="w"> </span>could<span class="w"> </span>have<span class="w"> </span>also<span class="w"> </span>used<span class="w"> </span>nvhpc-nompi/24.1<span class="w"> </span>or
<span class="w"> </span>even<span class="w"> </span>PrgEnv-nvhpc/8.5.0.
++++


nvc<span class="w"> </span>-fast<span class="w"> </span>-Minline<span class="w"> </span>-Minfo<span class="w"> </span>-acc<span class="w"> </span>-DFP64<span class="w"> </span>nbodyacc2.c<span class="w"> </span>-o<span class="w"> </span>nbody


:<span class="w"> </span>Run<span class="w"> </span>on<span class="w"> </span>all<span class="w"> </span>of<span class="w"> </span>our<span class="w"> </span>nodes
<span class="nv">nlist</span><span class="o">=</span><span class="sb">`</span>scontrol<span class="w"> </span>show<span class="w"> </span>hostnames<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>l<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$nlist</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w">   </span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$l</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span>GPU<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
:<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>one<span class="w"> </span>way<span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>the<span class="w"> </span>GPU<span class="w"> </span>on<span class="w"> </span>which<span class="w"> </span>a<span class="w"> </span>openacc<span class="w"> </span>program<span class="w"> </span>runs.
<span class="w">      </span><span class="nb">export</span><span class="w"> </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="nv">$GPU</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>on<span class="w"> </span>gpu<span class="w"> </span><span class="nv">$CUDA_VISIBLE_DEVICES</span>
:<span class="w"> </span>Since<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>running<span class="w"> </span>MPI<span class="w"> </span>we<span class="w"> </span>actaully<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>need<span class="w"> </span>srun<span class="w"> </span>here.
<span class="w">      </span>srun<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>-w<span class="w"> </span><span class="nv">$l</span><span class="w"> </span>./nbody
<span class="w">  </span><span class="k">done</span>
<span class="w">  </span><span class="nb">echo</span>
<span class="k">done</span>

<span class="nb">unset</span><span class="w"> </span>CUDA_VISIBLE_DEVICES
</code></pre></div>
</details>
<h2 id="mpiopenacccray">mpi/openacc/cray<a class="headerlink" href="#mpiopenacccray" title="Permanent link">#</a></h2>
<p>This is a somewhat contrived example.  If does, in fact combine MPI and OpenACC but the MPI does almost nothing.  At the MPI level it is embarrassingly parallel and each MPI task does the same calculation which is enhanced via OpenACC.  MPI starts the tasks and reports a summary of timings.  However, MPI combined with OpenACC is a important paradigm.  The GPU version of VASP can combine MPI and OpenACC.</p>
<p>Here we load PrgEnv-nvhpc which requires cray-libsci/23.05.1.4 giving us Cray MPI and nvidia backend compilers.  Again recall that cc and ftn are wrappers that will build MPI and non-MPI programs.  </p>
<p>We launch with srun since PrgEnv-* supports the slurm scheduler.</p>
<details class="example">
<summary>mpi/openacc/cray</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>PrgEnv-nvhpc
ml<span class="w"> </span>cray-libsci/23.05.1.4
ml<span class="w"> </span>binutils

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program.

<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>cc<span class="w"> </span>and<span class="w"> </span>ftn.<span class="w">  </span>These<span class="w"> </span>are<span class="w"> </span>wrappers
<span class="w"> </span>that<span class="w"> </span>point<span class="w"> </span>to<span class="w"> </span>Cray<span class="w"> </span>C<span class="w"> </span><span class="o">(</span>clang<span class="o">)</span><span class="w"> </span>Cray<span class="w"> </span>Fortran
<span class="w"> </span>and<span class="w"> </span>Cray<span class="w"> </span>MPI.<span class="w"> </span>cc<span class="w"> </span>and<span class="w"> </span>ftn<span class="w"> </span>are<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>PrgEnv-cray
<span class="w"> </span>which<span class="w"> </span>is<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>setup.
++++

cc<span class="w"> </span>-acc<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-fast<span class="w"> </span>acc_c3.c<span class="w">  </span>-o<span class="w"> </span>jacobi

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span><span class="m">4</span><span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes.
srun<span class="w"> </span>--tasks-per-node<span class="o">=</span><span class="m">4</span><span class="w"> </span>./jacobi<span class="w"> </span><span class="m">46000</span><span class="w"> </span><span class="m">46000</span><span class="w"> </span><span class="m">5</span><span class="w"> </span>nvidia
</code></pre></div>
</details>
<h2 id="mpiopenaccnvidianrelopenmpi">mpi/openacc/nvidia/nrelopenmpi<a class="headerlink" href="#mpiopenaccnvidianrelopenmpi" title="Permanent link">#</a></h2>
<p>As discussed above this is a somewhat contrived example.  If does, in fact combine MPI and OpenACC but the MPI does almost nothing.  At the MPI level it is embarrassingly parallel and each MPI task does the same calculation which is enhanced via OpenACC.  MPI starts the tasks and reports a summary of timings.  However, MPI combined with OpenACC is a important paradigm.  The GPU version of VASP can combine MPI and OpenACC.</p>
<p>Here we load openmpi/4.1.6-nvhpc and  nvhpc-nompi/24.1 which together give us a Cuda aware MPI with NVIDIA's OpenACC compile capability.</p>
<p>We launch with srun since NREL's OpenMPI supports the slurm scheduler.</p>
<details class="example">
<summary>mpi/openacc/nvidia/nrelopenmpi</summary>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>doit
:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>openmpi/4.1.6-nvhpc
ml<span class="w"> </span>nvhpc-nompi/24.1
ml<span class="w"> </span>binutils

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpicc<span class="w"> </span>and<span class="w"> </span>mpif90.<span class="w">  </span>There<span class="w"> </span>is<span class="w"> </span>support<span class="w"> </span><span class="k">for</span><span class="w"> </span>Cuda
<span class="w"> </span>but<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>directly<span class="w"> </span>using<span class="w"> </span>it<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span><span class="k">case</span>,<span class="w"> </span>just<span class="w"> </span>openacc.
++++

mpicc<span class="w"> </span>-acc<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-fast<span class="w"> </span>acc_c3.c<span class="w"> </span>-o<span class="w"> </span>jacobi

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span><span class="m">4</span><span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes.
srun<span class="w"> </span>--tasks-per-node<span class="o">=</span><span class="m">4</span><span class="w"> </span>./jacobi<span class="w"> </span><span class="m">46000</span><span class="w"> </span><span class="m">46000</span><span class="w"> </span><span class="m">5</span><span class="w"> </span>nvidia
</code></pre></div>
</details>
<h2 id="mpiopenaccnvidianvidiaopenmpi">mpi/openacc/nvidia/nvidiaopenmpi<a class="headerlink" href="#mpiopenaccnvidianvidiaopenmpi" title="Permanent link">#</a></h2>
<p>As discussed above this is a somewhat contrived example.  If does, in fact combine MPI and OpenACC but the MPI does almost nothing.  At the MPI level it is embarrassingly parallel and each MPI task does the same calculation which is enhanced via OpenACC.  MPI starts the tasks and reports a summary of timings.  However, MPI combined with OpenACC is a important paradigm.  The GPU version of VASP can combine MPI and OpenACC.</p>
<p>Here we load PrgEnv-cray/8.5.0.  We do not unload  and  nvhpc-nompi/24.1 so we have NVIDIA's version of MPI in our path.  </p>
<p>We launch with mpirun since NVIDIA's MPI lacks support for the slurm scheduler.</p>
<details class="example">
<summary>mpi/openacc/nvidia/nvidiaopenmpi</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>nvhpc-stdalone/24.1


:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>program
<span class="w"> </span>Here<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpicc<span class="w"> </span>and<span class="w"> </span>mpif90.<span class="w">  </span>There<span class="w"> </span>is<span class="w"> </span>support<span class="w"> </span><span class="k">for</span><span class="w"> </span>Cuda
<span class="w"> </span>but<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>using<span class="w"> </span>it<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span><span class="k">case</span><span class="w"> </span>but<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>using<span class="w"> </span>
<span class="w"> </span>openacc.
++++

mpicc<span class="w"> </span>-acc<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-fast<span class="w"> </span>acc_c3.c<span class="w"> </span>-o<span class="w"> </span>jacobi

:<span class="w"> </span>We<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span><span class="m">4</span><span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span>nodes.
:<span class="w"> </span>This<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>MPI<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>srun<span class="w"> </span>so<span class="w"> </span>we<span class="w"> </span>use<span class="w"> </span>mpirun
mpirun<span class="w"> </span>-N<span class="w"> </span><span class="m">4</span><span class="w"> </span>./jacobi<span class="w"> </span><span class="m">46000</span><span class="w"> </span><span class="m">46000</span><span class="w"> </span><span class="m">5</span><span class="w"> </span>nvidia
</code></pre></div>
</details>
<h2 id="cudalibfactor">cudalib/factor<a class="headerlink" href="#cudalibfactor" title="Permanent link">#</a></h2>
<p>We have two programs here.  Both do a linear solve, actually a factorization.   cpu.C is a CPU program and it does its solve using a LAPACK routine dgetrs.  This program is built and run against Cray's libsci and Intel's MKL.  The program cusolver_getrf_example.cu calls a NVIDIA cuda linear solver cusolverDnDgetrf.</p>
<p>We first build cpu.C using PrgEnv-gnu.  Note that we need to load cuda even though we don't use it because PrgEnv-gnu expects it.</p>
<p>We next build the GPU version using nvhpc-stdalone which gives us access to Cuda and the libraries. For our compile/link line we need to provide the path to the include files and library.</p>
<p>Next we run these two examples.  For the CPU version we run using 32 threads.  For the GPU version we run on each of the GPUs in turn.  </p>
<p>For the Intel version we</p>
<div class="highlight"><pre><span></span><code>ml intel-oneapi-mkl
ml intel-oneapi-compilers
</code></pre></div>
<p>build and run.</p>
<details class="example">
<summary>cudalib/factor</summary>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>doit
:<span class="w"> </span>Size<span class="w"> </span>of<span class="w"> </span>our<span class="w"> </span>matrix<span class="w"> </span>to<span class="w"> </span>solve
<span class="nb">export</span><span class="w"> </span><span class="nv">MSIZE</span><span class="o">=</span><span class="m">4500</span>

:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
:<span class="w"> </span>We<span class="w"> </span>are<span class="w"> </span>going<span class="w"> </span>to<span class="w"> </span>Cray<span class="w"> </span>libsci<span class="w"> </span>version<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>GPU
:<span class="w"> </span>environment<span class="w"> </span>even<span class="w"> </span>though<span class="w"> </span>it<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>use<span class="w"> </span>GPUs
:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore

:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
<span class="c1">#module unload nvhpc/24.1</span>

ml<span class="w"> </span>PrgEnv-gnu/8.4.0<span class="w"> </span>
ml<span class="w"> </span>cuda

<span class="c1"># Here we build the CPU version with libsci We don&#39;t actaully use Cuda but the compiler wants it</span>
CC<span class="w">  </span>-DMINE<span class="o">=</span><span class="nv">$MSIZE</span><span class="w">  </span>-fopenmp<span class="w"> </span>-march<span class="o">=</span>native<span class="w"> </span>cpu.C<span class="w"> </span>-o<span class="w"> </span>invert.libsci

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>GPU<span class="w"> </span>programs.
<span class="w"> </span>The<span class="w"> </span>module<span class="w"> </span>nvhpc-native<span class="w"> </span>gives<span class="w"> </span>us<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>compilers
<span class="w"> </span>nvc,<span class="w"> </span>nvc++,<span class="w"> </span>nvcc,<span class="w"> </span>nvfortran<span class="w"> </span>as<span class="w"> </span>well<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>Portland<span class="w"> </span>Group<span class="w"> </span>
<span class="w"> </span>compilers<span class="w"> </span>which<span class="w"> </span>are<span class="w"> </span>actually<span class="w"> </span>links<span class="w"> </span>to<span class="w"> </span>these.
++++
<span class="c1">#ml nvhpc-native</span>
ml<span class="w"> </span>nvhpc-stdalone
:<span class="w"> </span>GPU<span class="w"> </span>version<span class="w"> </span>with<span class="w"> </span>libcusolver
<span class="nb">export</span><span class="w"> </span><span class="nv">L1</span><span class="o">=</span><span class="nv">$NVHPC_ROOT</span>/math_libs/lib64
<span class="nb">export</span><span class="w"> </span><span class="nv">L3</span><span class="o">=</span><span class="nv">$NVHPC_ROOT</span>/REDIST/cuda/12.3/targets/x86_64-linux/lib
nvcc<span class="w">  </span>-DMINE<span class="o">=</span><span class="nv">$MSIZE</span><span class="w"> </span>-L<span class="nv">$L1</span><span class="w"> </span>-lcusolver<span class="w"> </span>-L<span class="nv">$L3</span><span class="w"> </span>-lnvJitLink<span class="w"> </span>cusolver_getrf_example.cu<span class="w"> </span>-o<span class="w"> </span>invert.gpu


<span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">32</span>
<span class="nb">echo</span><span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span>++++++++++++++++++++++
<span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>libsci<span class="w"> </span>version<span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span>++++++++++++++++++++++
./invert.libsci

<span class="k">for</span><span class="w"> </span>GPU<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="nb">echo</span><span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span>++++++++++++++++++++++
<span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>gpu<span class="w"> </span>version<span class="w"> </span>on<span class="w"> </span>GPU<span class="w"> </span><span class="nv">$GPU</span>
<span class="nb">echo</span><span class="w"> </span>++++++++++++++++++++++
:<span class="w"> </span>invert.gpu<span class="w"> </span>will<span class="w"> </span><span class="nb">read</span><span class="w"> </span>the<span class="w"> </span>GPU<span class="w"> </span>on<span class="w"> </span>which<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span><span class="nb">command</span><span class="w"> </span>line
./invert.gpu<span class="w"> </span><span class="nv">$GPU</span>
<span class="k">done</span>

:<span class="w"> </span>We<span class="w"> </span>are<span class="w"> </span>going<span class="w"> </span>to<span class="w"> </span>compile<span class="w"> </span>the<span class="w"> </span>Intel<span class="w"> </span>version<span class="w"> </span>using<span class="w"> </span>
:<span class="w"> </span>the<span class="w"> </span>CPU<span class="w"> </span>environment
module_restore
ml<span class="w"> </span>intel-oneapi-mkl
ml<span class="w"> </span>intel-oneapi-compilers
icpx<span class="w">  </span>-DMINE<span class="o">=</span><span class="nv">$MSIZE</span><span class="w"> </span>-qopenmp<span class="w"> </span>-D__INTEL__<span class="w"> </span>-march<span class="o">=</span>native<span class="w"> </span>cpu.C<span class="w"> </span>-mkl<span class="w"> </span>-lmkl_rt<span class="w"> </span>-o<span class="w"> </span>invert.mkl

<span class="nb">echo</span><span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span>++++++++++++++++++++++
<span class="nb">echo</span><span class="w"> </span>running<span class="w"> </span>MKL<span class="w"> </span>version
<span class="nb">echo</span><span class="w"> </span>++++++++++++++++++++++

./invert.mkl

module<span class="w"> </span>unload<span class="w">  </span>intel-oneapi-compilers
module<span class="w"> </span>unload<span class="w"> </span>intel-oneapi-mkl

<span class="nb">unset</span><span class="w"> </span>L1
<span class="nb">unset</span><span class="w"> </span>L3
<span class="nb">unset</span><span class="w"> </span>OMP_NUM_THREADS
<span class="nb">unset</span><span class="w"> </span>MSIZE
</code></pre></div>
</details>
<h2 id="cudalibfft">cudalib/fft<a class="headerlink" href="#cudalibfft" title="Permanent link">#</a></h2>
<p>We are doing FFTs on a cube.  There are two versions.  3d_mgpu_c2c_example.cpp is a multi GPU program that will also run on a single GPU.  fftw3d.c calls fftw; in this case Cray's version.  fftw3d.c can also be compiled for 1d and 2d; see the source.</p>
<p>For the GPU version we use nvhpc-stdalone which gives us access to NVIDIA's compilers and libraries.  We compile with nvcc and also link with nvcc specifying the path to the Cuda fft library.</p>
<p>The first command line argument is the size of the cube.</p>
<p>In a single invocation the program will run on both 1 and then 4 GPUs.  If the second command line option is 1 it will run on a single GPU version then on all 4 gpus.  When it is 2 it will run the 4 gpu version first.  </p>
<p>We actually run the code 4 times and see different runtimes.</p>
<p>For the FFTW version we load ml  PrgEnv-cray/8.4.0, cray-fftw, and cuda.  This program does not use cuda but the MPI compiler requires it for a proper link. </p>
<p>Again we run on a cube of size 512.</p>
<details class="example">
<summary>cudalib/fft</summary>
<div class="highlight"><pre><span></span><code>:<span class="w"> </span>Start<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>known<span class="w"> </span>module<span class="w"> </span>state,<span class="w"> </span>the<span class="w"> </span>default
module_restore



:<span class="w"> </span>Load<span class="w"> </span>modules
<span class="c1">#module unload nvhpc/24.1</span>
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="si">${</span><span class="nv">MYGCC</span><span class="p">+x</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>gcc<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span><span class="nv">$MYGCC</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
ml<span class="w"> </span>nvhpc-stdalone
ml<span class="w"> </span>binutils

ml<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>gcc-stdalone/13.1.0<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>REPLACING<span class="w"> </span>gcc-stdalone/13.1.0<span class="w"> </span><span class="p">;</span><span class="w"> </span>ml<span class="w"> </span>gcc-stdalone/12.3.0<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>

:<span class="w"> </span>&lt;&lt;<span class="w"> </span>++++<span class="w"> </span>
<span class="w"> </span>Compile<span class="w"> </span>our<span class="w"> </span>GPU<span class="w"> </span>programs.
<span class="w"> </span>The<span class="w"> </span>module<span class="w"> </span>nvhpc-stdalone<span class="w"> </span>gives<span class="w"> </span>us<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>Nvidia<span class="err">&#39;</span>s<span class="w"> </span>compilers
<span class="w"> </span>nvc,<span class="w"> </span>nvc++,<span class="w"> </span>nvcc,<span class="w"> </span>nvfortran<span class="w"> </span>as<span class="w"> </span>well<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>Portland<span class="w"> </span>Group<span class="w"> </span>
<span class="w"> </span>compilers<span class="w"> </span>which<span class="w"> </span>are<span class="w"> </span>actually<span class="w"> </span>links<span class="w"> </span>to<span class="w"> </span>these.
++++

nvcc<span class="w"> </span>-O3<span class="w"> </span>-forward-unknown-to-host-compiler<span class="w">  </span>--generate-code<span class="o">=</span><span class="nv">arch</span><span class="o">=</span>compute_90,code<span class="o">=[</span>compute_90,sm_90<span class="o">]</span><span class="w"> </span>-std<span class="o">=</span>c++11<span class="w"> </span>-x<span class="w"> </span>cu<span class="w"> </span>3d_mgpu_c2c_example.cpp<span class="w"> </span>-c
<span class="nb">export</span><span class="w"> </span><span class="nv">L1</span><span class="o">=</span><span class="nv">$NVHPC_ROOT</span>/REDIST/math_libs/12.3/targets/x86_64-linux/lib
nvcc<span class="w">  </span>-o<span class="w"> </span>3dfft<span class="w"> </span>3d_mgpu_c2c_example.o<span class="w"> </span>-L<span class="nv">$L1</span><span class="w"> </span>-lcufft

:<span class="w"> </span>Run<span class="w"> </span>our<span class="w"> </span>program<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>cube.<span class="w"> </span>The<span class="w"> </span>first<span class="w"> </span>parameter<span class="w"> </span>gives<span class="w"> </span>our<span class="w"> </span>cube<span class="w"> </span>size.
:<span class="w"> </span><span class="m">2048</span><span class="w"> </span>should<span class="w"> </span>work<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>H100s.
:<span class="w"> </span>Second<span class="w"> </span>parameter<span class="w"> </span>determines<span class="w"> </span>which<span class="w"> </span>algorithm<span class="w"> </span>runs<span class="w"> </span>first<span class="w"> </span><span class="m">1</span><span class="w"> </span>GPU<span class="w"> </span>version<span class="w"> </span>or<span class="w"> </span><span class="m">4</span><span class="w"> </span>GPU<span class="w"> </span>version
<span class="nb">echo</span>
<span class="nb">echo</span>
<span class="k">for</span><span class="w"> </span>DOIT<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>seq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">4</span><span class="sb">`</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">$DOIT</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span>++++++++++++++
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span>RUN<span class="w"> </span>SINGLE<span class="w"> </span>GPU<span class="w"> </span>VERSION<span class="w"> </span>FIRST
<span class="w">  </span>./3dfft<span class="w"> </span><span class="m">512</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="nb">echo</span>
<span class="w">  </span><span class="nb">echo</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span>++++++++++++++
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span>RUN<span class="w"> </span>FOUR<span class="w"> </span>GPU<span class="w"> </span>VERSION<span class="w"> </span>FIRST
<span class="w">  </span>./3dfft<span class="w"> </span><span class="m">512</span><span class="w"> </span><span class="m">2</span>
<span class="w">  </span><span class="nb">echo</span>
<span class="w">  </span><span class="nb">echo</span>
<span class="k">done</span>

:<span class="w"> </span>Build<span class="w"> </span>and<span class="w"> </span>run<span class="w"> </span>a<span class="w"> </span>fftw<span class="w"> </span>version
module_restore
<span class="c1">#module unload nvhpc/24.1</span>
<span class="c1">#module unload PrgEnv-cray/8.5.0</span>
ml<span class="w">  </span>PrgEnv-cray/8.4.0<span class="w"> </span>

ml<span class="w"> </span>cray-fftw
ml<span class="w"> </span>cuda
cc<span class="w"> </span>-O3<span class="w"> </span>fftw3d.c<span class="w"> </span>-o<span class="w"> </span>fftw3.exe

<span class="nb">echo</span>
<span class="nb">echo</span>
<span class="nb">echo</span><span class="w"> </span>++++++++++++++
<span class="nb">echo</span><span class="w"> </span>run<span class="w"> </span>fftw<span class="w"> </span>libsci<span class="w"> </span>version
./fftw3.exe<span class="w"> </span><span class="m">512</span>
</code></pre></div>
</details>
<h2 id="source-credits">Source credits<a class="headerlink" href="#source-credits" title="Permanent link">#</a></h2>
<ol>
<li>stream.cu - https://github.com/bcumming/cuda-stream with mods for MPI</li>
<li>nbodyacc2.c - Nvidia, part of the nvhpc distribution</li>
<li>acc_c3.c - Nvidia, part of the nvhpc distribution</li>
<li>helloc.c, hellof.f90 - Tim Kaiser tkaiser2@nrel.gov</li>
<li>ping_pong_cuda_aware.cu, ping_pong_cuda_staged.cu <a href="">https://github.com/olcf-tutorials/MPI_ping_pong</a></li>
<li>cpu.C - Multiple sources with significant mods </li>
<li>cusolver_getrf_example.cu - https://github.com/NVIDIA/CUDALibrarySamples.git with significant mods</li>
<li>3d_mgpu_c2c_example.cpp - https://github.com/NVIDIA/CUDALibrarySamples.git</li>
<li>ftw3d.c - Tim Kaiser tkaiser2@nrel.gov</li>
</ol>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
       <footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
  <nav class="md-footer__inner md-grid" aria-label="footer.title">

    <!-- Link to previous page -->
    
    
    <a href="../tutorial/" class="md-footer__link md-footer__link--prev"
      aria-label="Previous: Environments Tutorial" rel="prev">
      <div class="md-footer__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </div>
      <div class="md-footer__title">
        <div class="md-ellipsis">
          <span class="md-footer__direction">
            Previous
          </span>
          Environments Tutorial
        </div>
      </div>
    </a>
    

    <!-- Link to next page -->
    
    
    <a href="../../../Swift/" class="md-footer__link md-footer__link--next"
      aria-label="Next: Swift" rel="next">
      <div class="md-footer__title">
        <div class="md-ellipsis">
          <span class="md-footer__direction">
            Next
          </span>
          Swift
        </div>
      </div>
      <div class="md-footer__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
      </div>
    </a>
    
  </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <a href="https://www.nrel.gov/computational-science/" title="Computational Science at NREL">Computational
          Science at NREL</a><br>
        <a href="https://www.nrel.gov/hpc/about-hpc.html" target="_blank"
          title="About NREL High-Performance Computing">About NREL High-Performance Computing</a><br>
        <a href="https://www.nrel.gov/hpc/contact-us.html" target="_blank" title="Contact Us">Contact Us</a><br>
      </div>
    </div>
  </div>
  <footer>
    
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.tabs", "navigation.indexes", "announce.dismiss"], "search": "../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>